import{d as O,c as F,x as H,r as s,E as J,y as K,f as Q,w as l,o as W,h as e,G as D,i as E,j as R,n as N,t as P,P as $,k as X,e as r}from"./index-BFEiEqzV.js";import{B as Y}from"./BaseLayout-qpe1goZP.js";import{g as Z}from"./vue3-datatable-4DUKYgRc.js";import"./topBarUserProfile-DObMqA0B.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee=X("p",{class:"p3"},null,-1),de={__name:"SetStandardActions",setup(te){const i=O.useToast();F();const m=H(),u=s(!1),v=s(null),f=s(!1),b=s(!1),_=s(!1),S=s(!1),n=s(!1),U=s(null),M=()=>{const o=v.value.getSelectedRows();o&&o.length>0?(S.value=!1,d.value.actions=o[0].actions,d.value.id=o[0].id):S.value=!0,U.value=o.map(t=>t.id)[0]},d=s({actions:"",id:""}),T=async()=>{n.value=!0;const{valid:o}=await u.value.validate();if(!o){n.value=!1;return}try{const t=await m.post("saveAction",d.value);t.data&&t.data.success?(i.success("Successfully added"),g(),f.value=!1,u.value.reset(),v.value.clearSelectedRows()):i.error("Something went wrong")}catch(t){console.log(t)}finally{n.value=!1}},j=async()=>{n.value=!0;const{valid:o}=await u.value.validate();if(!o){n.value=!1;return}d.value.id===""&&(i.error("Please select atleast one row"),n.value=!1);try{const t=await m.put("editActions",d.value);t.data&&t.data.success?(i.success("Successfully updated"),g(),_.value=!1,u.value.reset(),v.value.clearSelectedRows()):i.error("Something went wrong")}catch(t){console.log(t)}finally{n.value=!1}},z=async()=>{n.value=!0;try{const o=await m.delete("deleteAction",{params:{id:U.value}});o.data&&o.data.success?(i.success("Successfully deleted"),g(),b.value=!1,u.value.reset(),v.value.clearSelectedRows()):i.error("Something went wrong")}catch(o){console.log(o)}finally{n.value=!1}},V=s(!0);s(0);const p=J({current_page:1,pagesize:10,sort_column:"id",sort_direction:"desc"}),I=s(null),G=s([{field:"id",title:"ID",isUnique:!0,type:"number",hide:!1},{field:"actions",title:"Standard Actions"},{field:"created_at",title:"Created_at"},{field:"updated_at",title:"Updated_at"}])||[],g=async()=>{try{V.value=!0;const t=(await m.get("getStandardActions")).data.actions;I.value=t}catch(o){console.log(o)}V.value=!1};return K(()=>{g()}),(o,t)=>{const c=r("v-btn"),w=r("v-divider"),A=r("v-text-field"),k=r("v-card-text"),y=r("v-spacer"),C=r("v-card-actions"),q=r("v-form"),x=r("v-card"),h=r("v-dialog"),B=r("v-col"),L=r("v-row");return W(),Q(Y,null,{default:l(()=>[e(x,{class:"m-3"},{default:l(()=>[e(L,{class:"pa-3"},{default:l(()=>[e(B,{lg:"8",md:"8",sm:"6",cols:"12"},{default:l(()=>[e(h,{width:"800",scrollable:"",modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=a=>f.value=a)},{activator:l(({props:a})=>[e(c,D({color:"primary","prepend-icon":"mdi-plus",text:"Create",class:"text-none"},a),null,16)]),default:l(()=>[e(x,{title:"Standard Actions"},{default:l(()=>[e(q,{onSubmit:E(T,["prevent"]),ref_key:"form",ref:u},{default:l(()=>[e(w,{class:"mt-1"}),e(k,{class:"px-4"},{default:l(()=>[e(A,{modelValue:d.value.actions,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value.actions=a),"single-line":"","prepend-inner-icon":"mdi-forum",rules:[a=>!!a||"Required"],density:"compact",variant:"outlined",label:"Standard Action",clearable:""},null,8,["modelValue","rules"])]),_:1}),e(w),e(C,null,{default:l(()=>[e(c,{text:"Close",prependIcon:"mdi-arrow-left",class:"text-none",onClick:t[1]||(t[1]=a=>f.value=!1)}),e(y),e(c,{type:"submit",color:"primary",prependIcon:"mdi-content-save-check-outline",class:"text-none",text:"Save",variant:"flat",loading:n.value},null,8,["loading"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),e(h,{width:"800",scrollable:"",modelValue:_.value,"onUpdate:modelValue":t[5]||(t[5]=a=>_.value=a)},{activator:l(({props:a})=>[e(c,D({color:"primary","prepend-icon":"mdi-file-edit-outline",text:"Edit",class:"text-none ml-2",variant:"tonal"},a),null,16)]),default:l(()=>[e(x,{title:"Standard Actions"},{default:l(()=>[e(q,{onSubmit:E(j,["prevent"]),ref_key:"form",ref:u},{default:l(()=>[e(w,{class:"mt-1"}),e(k,{class:"px-4"},{default:l(()=>[e(A,{modelValue:d.value.actions,"onUpdate:modelValue":t[3]||(t[3]=a=>d.value.actions=a),"single-line":"","prepend-inner-icon":"mdi-forum",rules:[a=>!!a||"Required"],density:"compact",variant:"outlined",label:"Standard Action",clearable:""},null,8,["modelValue","rules"])]),_:1}),e(w),e(C,null,{default:l(()=>[e(c,{text:"Close",prependIcon:"mdi-arrow-left",class:"text-none",onClick:t[4]||(t[4]=a=>_.value=!1)}),e(y),e(c,{type:"submit",color:"primary",prependIcon:"mdi-content-save-check-outline",class:"text-none",text:"Save",variant:"flat",loading:n.value},null,8,["loading"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),e(h,{width:"400",scrollable:"",modelValue:b.value,"onUpdate:modelValue":t[6]||(t[6]=a=>b.value=a)},{activator:l(({props:a})=>[e(c,D({color:"error",disabled:S.value,"prepend-icon":"mdi-delete-empty",text:"Delete",class:"text-none ml-2",variant:"plain"},a),null,16,["disabled"])]),default:l(({isActive:a})=>[e(x,{"prepend-icon":"mdi-trash-can",subtitle:"Delete"},{default:l(()=>[ee,e(k,null,{default:l(()=>[R("Are you sure you want to delete?")]),_:1}),e(C,null,{default:l(()=>[e(c,{text:"Close",prependIcon:"mdi-arrow-left",class:"text-none",onClick:ae=>a.value=!1},null,8,["onClick"]),e(y),e(c,{color:"danger","prepend-icon":"mdi-shield-remove-outline",text:"Delete",class:"text-none ml-2",variant:"outlined",onClick:z,loading:n.value},null,8,["loading"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1}),e(y),e(B,{lg:"4",md:"4",sm:"6",cols:"12"},{default:l(()=>[e(A,{color:"primary",modelValue:p.search,"onUpdate:modelValue":t[7]||(t[7]=a=>p.search=a),clearable:"",density:"compact",label:"Search all fields",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(N(Z),{ref_key:"datatable",ref:v,rows:I.value,columns:N(G),loading:V.value,search:p.search,selectRowOnClick:!0,hasCheckbox:!0,sortable:!0,sortColumn:p.sort_column,sortDirection:p.sort_direction,skin:"bh-table-compact bh-table-bordered",class:"mt-5",onRowSelect:M},{created_at:l(a=>[R(P($(a.value.created_at)),1)]),updated_at:l(a=>[R(P($(a.value.updated_at)),1)]),_:1},8,["rows","columns","loading","search","sortColumn","sortDirection"])]),_:1})]),_:1})}}};export{de as default};
