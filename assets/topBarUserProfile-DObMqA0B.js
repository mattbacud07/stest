import{a as G,g as $,u as D,c as N,r as x,J as q,b8 as E,L as F,y as J,e as r,o as s,f as k,w as e,h as t,I as L,p as S,F as B,z as U,G as T,j as d,t as c,l as j,k as A,n as R}from"./index-BFEiEqzV.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H=[{name:"AdminDashboard",module:"Dashboard",icong:"mdi-tablet-dashboard"},{name:"#",module:"Account Management",icong:"mdi-account-multiple",children:[{name:"RolesMain",module:"Roles & Permission",icong:"mdi-account-badge"},{name:"ApprovalConfiguration",module:"Aprover Config",icong:"mdi-checkbox-multiple-outline"}]},{name:"#",module:"General Settings",icong:"mdi-file-document",children:[{name:"SetStandardActions",module:"Set Standard Actions",icong:"mdi-text-box-check-outline"},{name:"ChecklistItem",module:"Checklist Item",icong:"mdi-file-document-plus"}]},{name:"ServiceLogs",module:"General Logs",icong:"mdi-list-status"}],Y={__name:"BaseSidebar",setup(P){const _=G(),h=$(),p=h.currentUserRole,v=D(),b=N(),f=x(p),n=x([]),g=x(!1),I=()=>{h.setCurrentUserRole(f.value),_.buildAbility(),v.push("/",{replace:!0})},V=q(()=>{const C={module:"Dashboard",create:!0,read:!0,edit:!0,delete:!0,approve:!0,delegate:!0,installer:!0,report:!1,name:"dashboard",icong:"mdi-view-dashboard-variant"},a=n.value.find(o=>h.currentUserRole===o.role_id),m=[C];if(a){const o=JSON.parse(a==null?void 0:a.permissions),i=(o==null?void 0:o.filter(l=>l.read))||[];if(a.role_id===E)return[...H];if(a.role_id===F){let l=[];return l=i.filter(w=>b.user.approval_level.length>0&&w.module==="Equipment Handling"||b.user.approval_level_pullout.length>0&&w.module==="PullOut Request"),[...m,...l]}return[...m,...i]}});return J(()=>{n.value.push(...b.user.user_roles),g.value=n.value.length!==1}),(C,a)=>{const m=r("v-select"),o=r("v-list-item"),i=r("v-icon"),l=r("v-list-item-title"),w=r("v-list-group"),M=r("v-list");return s(),k(M,{dense:""},{default:e(()=>[t(o,null,{default:e(()=>[g.value?(s(),k(m,{key:0,modelValue:f.value,"onUpdate:modelValue":[a[0]||(a[0]=u=>f.value=u),I],class:"mt-3 mb-3",transition:"fab-transition",items:n.value,"item-title":"role_name","item-value":"role_id",density:"compact",variant:"outlined",label:"Switch Account","append-inner-icon":"mdi-account-outline"},null,8,["modelValue","items"])):L("",!0)]),_:1}),n.value.length>0?(s(!0),S(B,{key:0},U(V.value,(u,ee)=>(s(),S(B,null,[u.children?(s(),k(w,{key:0},{activator:e(({props:y})=>[t(o,T({color:"primary"},y),{prepend:e(()=>[t(i,{class:"myIcon"},{default:e(()=>[d(c(u.icong),1)]),_:2},1024)]),default:e(()=>[t(l,{color:"primary"},{default:e(()=>[d(c(u.module),1)]),_:2},1024)]),_:2},1040)]),default:e(()=>[(s(!0),S(B,null,U(u.children,(y,O)=>(s(),k(o,{key:O,to:{name:y.name},link:"","active-class":"active-link"},{prepend:e(()=>[t(i,{class:"myIcon"},{default:e(()=>[d(c(y.icong),1)]),_:2},1024)]),default:e(()=>[t(l,null,{default:e(()=>[d(c(y.module),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:2},1024)):(s(),k(o,{key:1,to:{name:u.name},link:"","active-class":"active-link"},{prepend:e(()=>[t(i,{class:"myIcon"},{default:e(()=>[d(c(u.icong),1)]),_:2},1024)]),default:e(()=>[t(l,null,{default:e(()=>[d(c(u.module),1)]),_:2},1024)]),_:2},1032,["to"]))],64))),256)):L("",!0)]),_:1})}}},ne=z(Y,[["__scopeId","data-v-9b58e7fa"]]),K={class:"text-right pa-4"},Q={class:"text-dark"},W=A("br",null,null,-1),X={key:0,class:"small mr-4"},Z={class:"text-dark"},ae={__name:"topBarUserProfile",setup(P){const _=N(),h=j();D();const p=x(!1),v=x(!1),b=async()=>{p.value=!0;try{await h.log_me_out(),window.location.href="/",p.value=!1}catch(f){alert(f)}finally{p.value=!1}};return(f,n)=>{var a,m,o,i;const g=r("v-btn"),I=r("v-spacer"),V=r("v-card"),C=r("v-dialog");return s(),S("div",K,[t(g,{onClick:n[0]||(n[0]=l=>v.value=!0),color:"primary",class:"text-none","prepend-icon":"mdi-account"},{default:e(()=>[A("span",Q,[A("b",null,c(R(_).user.first_name)+" "+c(R(_).user.last_name),1)]),d(" | Logout ")]),_:1}),W,((o=(m=(a=R(_))==null?void 0:a.user)==null?void 0:m.user_roles)==null?void 0:o.length)===1?(s(),S("span",X,[d("Logged in as : "),A("b",Z,c((i=R(_).user.user_roles[0])==null?void 0:i.role_name),1)])):L("",!0),t(C,{modelValue:v.value,"onUpdate:modelValue":n[2]||(n[2]=l=>v.value=l),width:"auto"},{default:e(()=>[t(V,{"min-width":"300","prepend-icon":"mdi-account",text:"Are you sure you want to leave?",title:"Logout"},{actions:e(()=>[t(I),t(g,{class:"text-none",variant:"tonal",color:"primary",text:"Cancel",onClick:n[1]||(n[1]=l=>v.value=!1)}),t(g,{class:"text-none",color:"primary","min-width":"150px",variant:"flat",text:"Yes",loading:p.value,onClick:b},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"])])}}};export{ne as B,ae as _};
