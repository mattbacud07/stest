import{d as ie,v as ne,u as re,Y as de,c as me,x as pe,r as d,J as ce,y as ve,f as $,w as l,i as fe,e as n,o as x,h as e,p as G,z as _e,F as H,j as R,_ as ye,n as m,k as V,G as be,t as q,$ as Ve,a0 as ge,Z as qe,M as De,H as ke}from"./index-BFEiEqzV.js";import{O as z}from"./vue-datepicker-Cw0Icon6.js";/* empty css             */import{m as Ue,a as we,b as xe,o as Re,r as Ce}from"./master_data-ZlZ6Ytdf.js";import{L as Se}from"./LayoutSinglePage-DJUeRI8X.js";import{_ as J}from"./lodash-ByxqToh2.js";import{p as Ie}from"./maintenance-C4GvCYOP.js";import{u as Me}from"./getInstitution-BUyxC4El.js";import{a as ze}from"./getUsers-CkOTfKF4.js";import{_ as Ae}from"./VDialog-DT5M5bWF.js";import"./topBarUserProfile-DObMqA0B.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Be=V("p",{class:"mb-2 text-grey-darken-1"},"Admission Date",-1),Te=V("p",{class:"mb-2 text-grey-darken-1"},"Date Installed",-1),Ee=V("p",{class:"mb-2 text-grey-darken-1"},"Contract Due Date",-1),We={__name:"EditMasterData",setup(je){const D=ie.useToast(),{name:Fe,width:Y}=ne(),A=re(),Z=de();me();const C=pe();d(null);const B=d(!1);d(!1),d(!1);const T=d(!1),g=d(!1);d(null);const K=[{title:"Back",disabled:!1,href:"/master-data"},{title:"Master Data",disabled:!0,href:""},{title:"Create-Master-Data",disabled:!0,href:""}],Q=u=>{!u.disabled&&u.href&&A.push(u.href)},E=Z.params.id,t=d({institution:"",address:"",item_code:"",description:"",item_id:"",equipment:"",serial:"",sbu:"",dealer_name:"",area:"",operation_time:"",software_version:"",admission_date:"",date_installed:"",contract_due_date:"",region:"",frequency:"",analyzer_type:"",class:"",initially_installed:"",reason_equipment_status:"",email:"",mode:"",supplier:"",status:""}),W=u=>{t.value.address=u.address},_=d({institutionValue:[u=>!!u||"Required"],address:[u=>u&&u.trim()!==""||"Required"],item_code:[u=>u&&u.trim()!==""||"Required"],equipment:[u=>u&&u.trim()!==""||"Required"],serial:[u=>u&&u.trim()!==""||"Required"],mode:[u=>u&&u.trim()!==""||"Required"],supplier:[u=>!!u||"Required"],status:[u=>u&&u.trim()!==""||"Required"]}),X=async()=>{var s,f,v;g.value=!0;const{valid:u}=await B.value.validate();if(!S.value){D.error("No changes made"),g.value=!1;return}if(!u){D.error("Please ensure that required fields are not left blank"),g.value=!1;return}try{const p=await C.put("editMasterData",{id:E,...t.value,institution:typeof t.value.institution=="object"?(s=t.value.institution)==null?void 0:s.id:t.value.institution,initially_installed:typeof t.value.initially_installed=="object"?(f=t.value.initially_installed)==null?void 0:f.id:t.value.initially_installed,supplier:typeof t.value.supplier=="object"?(v=t.value.supplier)==null?void 0:v.id:t.value.supplier});p.data&&p.data.success?(D.success("Item successfully updated"),T.value=!0,F()):D.error("Something went wrong")}catch(p){console.error(p)}finally{g.value=!1,T.value=!1}},b=d(!0),{institutions:h}=Me(),j=d([]),ee=async()=>{var u;try{b.value=!0;const s=await C.get("get_supplier");(u=s.data)!=null&&u.supplier&&(j.value=s.data.supplier)}catch(s){console.log(s)}b.value=!1},{users:le}=ze(),F=async()=>{var u,s,f;try{b.value=!0;const v=await C.get("viewMasterDataByRowID",{params:{id:E}}),p=v==null?void 0:v.data.data;Object.entries(p).forEach(([o,I])=>{t.value[o]=I}),t.value.address=(u=p.institution_data)==null?void 0:u.address,t.value.item_code=(s=p.master_data)==null?void 0:s.item_code,t.value.description=(f=p.master_data)==null?void 0:f.description,N.value=J.cloneDeep(t.value)}catch(v){console.log(v)}finally{b.value=!1}},N=d({}),S=ce(()=>!J.isEqual(t.value,N.value)),k=d(!1),ae=()=>{if(S.value){k.value=!0;return}P()},P=()=>{k.value=!1,A.push("/master-data")};return ve(()=>{F(),ee()}),(u,s)=>{const f=n("v-icon"),v=n("v-breadcrumbs-item"),p=n("v-breadcrumbs"),o=n("v-col"),I=n("v-spacer"),L=n("v-btn"),r=n("v-skeleton-loader"),i=n("v-row"),M=n("v-combobox"),c=n("v-text-field"),U=n("v-card"),y=n("v-select"),te=n("v-hover"),se=n("v-container"),oe=n("v-form");return x(),$(oe,{onSubmit:fe(X,["prevent"]),ref_key:"form",ref:B},{default:l(()=>[e(Se,null,{topBarFixed:l(()=>[e(o,{lg:"6",md:"6",sm:"8",cols:"8"},{default:l(()=>[e(p,{class:"pt-7"},{default:l(()=>[(x(),G(H,null,_e(K,(a,w)=>e(v,{key:w,class:qe({"custom-pointer":!a.disabled}),style:De({display:m(Y)<=768?a.display:""}),onClick:O=>Q(a),disabled:a.disabled},{default:l(()=>[R(q(a.title)+" ",1),e(f,{class:"ml-1",icon:"mdi-chevron-right"})]),_:2},1032,["class","style","onClick","disabled"])),64))]),_:1})]),_:1}),e(I),e(o,{lg:"6",md:"6",sm:"4",cols:"4","align-self":"center",class:"d-flex justify-end"},{default:l(()=>[e(L,{disabled:g.value,onClick:ae,color:"primary",variant:"tonal",class:"text-none mr-2"},{default:l(()=>[R(" Cancel ")]),_:1},8,["disabled"]),e(L,{type:"submit",loading:b.value,disabled:!S.value,color:"primary",variant:"flat",class:"text-none btnSubmit"},{default:l(()=>[e(f,{class:"mr-2"},{default:l(()=>[R("mdi-content-save-check-outline")]),_:1}),R(" Save ")]),_:1},8,["loading","disabled"])]),_:1})]),default:l(()=>[b.value?(x(),G(H,{key:0},[e(i,null,{default:l(()=>[e(o,{cols:"6"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1}),e(o,{cols:"6"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1}),e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1}),e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1}),e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1}),e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"6"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1}),e(o,{cols:"6"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1}),e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1}),e(o,{cols:"4"},{default:l(()=>[e(r,{type:"list-item-three-line"})]),_:1})]),_:1})],64)):(x(),$(ye,{key:1,name:"slide-x-transition"},{default:l(()=>[e(se,{class:"container-form mt-15"},{default:l(()=>[e(U,{class:"pa-7 mb-5"},{default:l(()=>[e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(M,{modelValue:t.value.institution,"onUpdate:modelValue":[s[0]||(s[0]=a=>t.value.institution=a),s[1]||(s[1]=a=>W(a))],clearable:"",label:"Institution *",density:"compact",items:m(h),variant:"outlined",itemValue:"id",itemTitle:"name",rules:_.value.institutionValue,"close-on-content-click":!1,"hide-details":""},null,8,["modelValue","items","rules"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.address,"onUpdate:modelValue":s[2]||(s[2]=a=>t.value.address=a),label:"Address *",density:"compact",variant:"outlined",readonly:"","onUpdate:Item":"(newVal) => { address.value = newVal.key }",rules:_.value.address,"hide-details":""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.item_code,"onUpdate:modelValue":s[3]||(s[3]=a=>t.value.item_code=a),label:"Item Code",readonly:"",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.description,"onUpdate:modelValue":s[4]||(s[4]=a=>t.value.description=a),label:"Description",readonly:"",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.equipment,"onUpdate:modelValue":s[5]||(s[5]=a=>t.value.equipment=a),label:"Equipment *",clearable:"",density:"compact",variant:"outlined",rules:_.value.equipment},null,8,["modelValue","rules"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.serial,"onUpdate:modelValue":s[6]||(s[6]=a=>t.value.serial=a),label:"Serial Number *",clearable:"",density:"compact",variant:"outlined",rules:_.value.serial},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(U,{class:"pa-7 mb-5"},{default:l(()=>[e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(y,{color:"primary",modelValue:t.value.mode,"onUpdate:modelValue":s[7]||(s[7]=a=>t.value.mode=a),label:"Mode *",clearable:"",density:"compact",variant:"outlined",rules:_.value.mode,items:m(Ue)},null,8,["modelValue","rules","items"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(M,{modelValue:t.value.supplier,"onUpdate:modelValue":s[8]||(s[8]=a=>t.value.supplier=a),clearable:"",label:"Supplier *",density:"compact",items:j.value,variant:"outlined",itemValue:"id",itemTitle:"name",rules:_.value.institutionValue,"close-on-content-click":!1,"hide-details":""},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(y,{color:"primary",modelValue:t.value.sbu,"onUpdate:modelValue":s[9]||(s[9]=a=>t.value.sbu=a),label:"SBU *",clearable:"",density:"compact",variant:"outlined",rules:[a=>!!a||"Required"],items:m(ke)},null,8,["modelValue","rules","items"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(y,{color:"primary",modelValue:t.value.status,"onUpdate:modelValue":s[10]||(s[10]=a=>t.value.status=a),label:"Status *",clearable:"",density:"compact",variant:"outlined",rules:_.value.status,items:m(we)},null,8,["modelValue","rules","items"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.dealer_name,"onUpdate:modelValue":s[11]||(s[11]=a=>t.value.dealer_name=a),label:"Dealer Name",clearable:"",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(y,{color:"primary",modelValue:t.value.area,"onUpdate:modelValue":s[12]||(s[12]=a=>t.value.area=a),label:"Area Categorization",clearable:"",density:"compact",variant:"outlined",items:m(xe)},null,8,["modelValue","items"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(y,{color:"primary",modelValue:t.value.operation_time,"onUpdate:modelValue":s[13]||(s[13]=a=>t.value.operation_time=a),label:"Operation Time",clearable:"",density:"compact",variant:"outlined",items:m(Re)},null,8,["modelValue","items"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.software_version,"onUpdate:modelValue":s[14]||(s[14]=a=>t.value.software_version=a),label:"Software Version",clearable:"",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{class:"pa-7 mb-5"},{default:l(()=>[e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(y,{color:"primary",modelValue:t.value.frequency,"onUpdate:modelValue":s[15]||(s[15]=a=>t.value.frequency=a),label:"Frequency for PM *",clearable:"",density:"compact",variant:"outlined",rules:[a=>!!a||"Required"],items:m(Ie)},null,8,["modelValue","rules","items"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[Be,e(m(z),{modelValue:t.value.admission_date,"onUpdate:modelValue":s[16]||(s[16]=a=>t.value.admission_date=a),"auto-apply":"",teleport:!0,"enable-time-picker":!1,placeholder:"Admission Date *",rules:[a=>!!a||"Required"]},null,8,["modelValue","rules"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[Te,e(m(z),{modelValue:t.value.date_installed,"onUpdate:modelValue":s[17]||(s[17]=a=>t.value.date_installed=a),"auto-apply":"",teleport:!0,"enable-time-picker":!1,placeholder:"Date Installed"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[Ee,e(m(z),{modelValue:t.value.contract_due_date,"onUpdate:modelValue":s[18]||(s[18]=a=>t.value.contract_due_date=a),"auto-apply":"",teleport:!0,"enable-time-picker":!1,placeholder:"Contract Due Date"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{class:"pa-7 mb-5"},{default:l(()=>[e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(y,{color:"primary",modelValue:t.value.region,"onUpdate:modelValue":s[19]||(s[19]=a=>t.value.region=a),label:"Region",clearable:"",density:"compact",variant:"outlined",items:m(Ce)},null,8,["modelValue","items"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.analyzer_type,"onUpdate:modelValue":s[20]||(s[20]=a=>t.value.analyzer_type=a),label:"Analyzer Type *",clearable:"",density:"compact",variant:"outlined",rules:[a=>!!a||"Required"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.class,"onUpdate:modelValue":s[21]||(s[21]=a=>t.value.class=a),label:"Class",clearable:"",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(M,{color:"primary",modelValue:t.value.initially_installed,"onUpdate:modelValue":s[22]||(s[22]=a=>t.value.initially_installed=a),clearable:"",label:"Initially Installed",density:"compact",items:m(le),variant:"outlined",itemValue:"id",itemTitle:"first_name","close-on-content-click":!1,"hide-details":""},{item:l(({item:a,props:w})=>[V("p",Ve(ge(w)),[e(te,null,{default:l(({isHovering:O,props:ue})=>[V("p",be(ue,{style:{background:O?"#f2f2f2":"white"},class:"pa-2"}),q(a.raw.first_name)+" "+q(a.raw.last_name),17)]),_:2},1024)],16)]),selection:l(({item:a,index:w})=>[V("span",null,q(a.raw.first_name)+" "+q(a.raw.last_name),1)]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(o,{cols:"12",lg:"6",md:"6",sm:"6"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.reason_equipment_status,"onUpdate:modelValue":s[23]||(s[23]=a=>t.value.reason_equipment_status=a),label:"Reason for Equipment Status",clearable:"",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(o,{cols:"12",lg:"6",md:"6",sm:"6",class:"mb-5"},{default:l(()=>[e(c,{color:"primary",modelValue:t.value.email,"onUpdate:modelValue":s[24]||(s[24]=a=>t.value.email=a),label:"Email",clearable:"",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Ae,{modelValue:k.value,"onUpdate:modelValue":s[25]||(s[25]=a=>k.value=a),title:"Discard Changes",text:"Are you sure you want to leave?",onConfirm:P},null,8,["modelValue"])]),_:1})]),_:1}))]),_:1})]),_:1},512)}}};export{We as default};
