import{u as te}from"./getActionsTaken-CbFwF999.js";import{l as le}from"./lodash-ByxqToh2.js";import{g as ae}from"./vue3-datatable-4DUKYgRc.js";import{x as oe,r as v,C as se,E as ne,y as re,e as d,o as m,f as R,w as t,h as e,k as l,j as c,p as h,F as N,z as q,n as F,G as ie,t as k}from"./index-BFEiEqzV.js";const ue={class:"text-center text-grey"},de=l("b",{class:"text-primary"}," Status after service",-1),ce=l("p",{class:"text-primary"},"Customer Complaint",-1),me=l("p",{class:"text-primary"},"Cause of Problem",-1),pe=l("b",{class:"text-primary"},"Remarks and Recommendation",-1),_e=l("b",{class:"text-primary"},"Actions Taken",-1),fe=l("p",null,"No records found",-1),ve=l("h5",{class:"text-primary"},"Reagents / Spare Parts Used",-1),he={class:"table-responsive"},ye={class:"table table-sm table-bordered table-responsive"},be=l("thead",{style:{background:"#afafaf2e"}},[l("tr",null,[l("th",{scope:"col"},"Item Code"),l("th",{scope:"col"},"Item Description"),l("th",null,"Qty"),l("th",null,"DR#"),l("th",null,"SI#"),l("th",null,"Remarks"),l("th")])],-1),ge={key:0},Ve={key:1},ke={colspan:"7",class:"text-center p-3",style:{opacity:".3"}},xe=l("br",null,null,-1),Ce={class:"d-flex justify-content-start"},we={class:"text-danger"},Se=l("b",null,"List of Selected Row",-1),Ue=l("br",null,null,-1),Re={key:0},Ne={key:1,class:"small"},Me={__name:"ServiceReportForm",props:{modelValue:Object},emits:["update:modelValue"],setup(qe,{expose:j,emit:T}){const{actions_data:O}=te(),$=oe(),A=T,i=v({status_after_service:"",fields:[],spareparts:[],remarks:"",complaint:"",problem:""});se(i,n=>{A("update:modelValue",n)},{deep:!0});const b=v(!1);v([]);const B=v(!1),x=v(!1),z=v(0),D=v([{field:"id",title:"ID",isUnique:!0,type:"number",hide:!0},{field:"item_code",title:"Item Code"},{field:"description",title:"Item Description"},{field:"name",title:"Category"}])||[],E=D.value.map(n=>n.field),y=ne({current_page:1,pagesize:10,search:""}),I=v(null),C=async()=>{var n;try{x.value=!0;const o=await $.get("master-data-equipments",{params:{...y,searchColumn:E,item_category:[5,6]}}),_=(n=o==null?void 0:o.data)==null?void 0:n.equipments;I.value=_.data,z.value=_.total}catch(o){console.log(o)}x.value=!1},L=le.debounce(C,300),G=n=>{y.current_page=n.current_page,y.pagesize=n.pagesize,y.search=n.search,n.change_type==="search"?L():C()},Q=n=>{var o;(o=i.value.spareparts)==null||o.push({item_id:n.id,item_code:n.item_code,description:n.description,qty:null,dr:null,si:null,remarks:null})},P=n=>{var o;(o=i.value.spareparts)==null||o.splice(n,1)},H=()=>{i.value.fields.length<8&&i.value.fields.push({action:""})},J=n=>{i.value.fields.splice(n,1)},M=v(!1);return j({validateServiceForm:async()=>{const{valid:n}=await M.value.validate();return n}}),re(()=>{C()}),(n,o)=>{const _=d("v-icon"),f=d("v-row"),w=d("v-radio"),K=d("v-radio-group"),p=d("v-col"),S=d("v-textarea"),U=d("v-btn"),W=d("v-combobox"),V=d("v-card"),g=d("v-text-field"),X=d("v-spacer"),Y=d("v-divider"),Z=d("v-overlay"),ee=d("v-form");return m(),R(ee,{ref_key:"serviceForm",ref:M},{default:t(()=>[e(V,{density:"compact",class:"pa-7",elevation:"1"},{default:t(()=>[e(f,null,{default:t(()=>[l("h4",ue,[e(_,null,{default:t(()=>[c("mdi-chart-bar-stacked")]),_:1}),c(" Service Report")])]),_:1}),e(f,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[de,e(K,{modelValue:i.value.status_after_service,"onUpdate:modelValue":o[0]||(o[0]=s=>i.value.status_after_service=s),rules:[s=>!!s||"Required"],inline:""},{default:t(()=>[e(w,{label:"Operational",value:"Operational"}),e(w,{label:"For further monitoring",value:"Further Monitoring"}),e(w,{label:"Non-operational",value:"Non-Operational"})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(p,{cols:"12",md:"6",sm:"6",lg:"6"},{default:t(()=>[ce,e(S,{modelValue:i.value.complaint,"onUpdate:modelValue":o[1]||(o[1]=s=>i.value.complaint=s),color:"primary",variant:"outlined",placeholder:"Type your remarks & recommendations here ...",rules:[s=>s&&s.length<=120||"Please limit your input to 120 characters"]},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12",md:"6",sm:"6",lg:"6"},{default:t(()=>[me,e(S,{modelValue:i.value.problem,"onUpdate:modelValue":o[2]||(o[2]=s=>i.value.problem=s),color:"primary",variant:"outlined",placeholder:"Type your remarks & recommendations here ...",rules:[s=>s&&s.length<=120||"Please limit your input to 120 characters"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[pe,e(S,{modelValue:i.value.remarks,"onUpdate:modelValue":o[3]||(o[3]=s=>i.value.remarks=s),color:"primary",variant:"outlined",placeholder:"Type your remarks & recommendations here ...",rules:[s=>s&&s.length<=120||"Please limit your input to 120 characters"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(p,{class:"d-flex justify-content-between align-items-center"},{default:t(()=>[_e,e(U,{onClick:H,class:"text-none",color:"primary",variant:"text","prepend-icon":"mdi-comment-plus-outline"},{default:t(()=>[c("Add Field")]),_:1})]),_:1})]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(V,{elevation:"0"},{default:t(()=>[e(f,null,{default:t(()=>[i.value.fields.length>0?(m(!0),h(N,{key:0},q(i.value.fields,(s,r)=>(m(),R(p,{cols:"12",key:r},{default:t(()=>[e(W,{modelValue:s.action,"onUpdate:modelValue":u=>s.action=u,items:F(O),"item-title":"actions","item-value":"actions",label:"Select an option or enter your action manually","append-inner-icon":"mdi-trash-can-outline",variant:"outlined",color:"primary",class:"mt-3",density:"compact",clearable:"",rules:[u=>!!(u!=null&&u.trim())||"Required",u=>u&&u.length<=120||"Please limit your input to 120 characters"],"onClick:appendInner":u=>J(r)},{item:t(({item:u,props:a})=>[l("p",ie(a,{class:"pa-2 selecting_action"}),[e(_,null,{default:t(()=>[c("mdi-circle-medium")]),_:1}),c(" "+k(u.title),1)],16)]),_:2},1032,["modelValue","onUpdate:modelValue","items","rules","onClick:appendInner"])]),_:2},1024))),128)):(m(),R(p,{key:1},{default:t(()=>[fe]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),e(V,{density:"compact",class:"p-3 mt-4",elevation:"0"},{default:t(()=>[e(f,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>{var s;return[e(f,null,{default:t(()=>[e(p,{class:"d-flex justify-content-between mb-3"},{default:t(()=>[ve]),_:1})]),_:1}),l("div",he,[l("table",ye,[be,((s=i.value.spareparts)==null?void 0:s.length)>0?(m(),h("tbody",ge,[(m(!0),h(N,null,q(i.value.spareparts,(r,u)=>(m(),h("tr",{key:u},[l("td",null,k(r.item_code),1),l("td",null,k(r.description),1),l("td",null,[e(g,{modelValue:r.qty,"onUpdate:modelValue":a=>r.qty=a,placeholder:"...",rules:[a=>!!(a!=null&&a.trim())||"required",a=>!isNaN(a)||"Mus tbe a number"],density:"compact",variant:"plain"},null,8,["modelValue","onUpdate:modelValue","rules"])]),l("td",null,[e(g,{modelValue:r.dr,"onUpdate:modelValue":a=>r.dr=a,placeholder:"...",rules:[a=>!!(a!=null&&a.trim())||"required",a=>!isNaN(a)||"Mus tbe a number"],density:"compact",variant:"plain"},null,8,["modelValue","onUpdate:modelValue","rules"])]),l("td",null,[e(g,{modelValue:r.si,"onUpdate:modelValue":a=>r.si=a,placeholder:"...",rules:[a=>!!(a!=null&&a.trim())||"required",a=>!isNaN(a)||"Mus tbe a number"],density:"compact",variant:"plain"},null,8,["modelValue","onUpdate:modelValue","rules"])]),l("td",null,[e(g,{modelValue:r.remarks,"onUpdate:modelValue":a=>r.remarks=a,placeholder:"Type here ...",variant:"plain"},null,8,["modelValue","onUpdate:modelValue"])]),l("td",null,[e(_,{onClick:a=>P(u),class:"text-danger"},{default:t(()=>[c("mdi-trash-can-outline")]),_:2},1032,["onClick"])])]))),128))])):(m(),h("tbody",Ve,[l("tr",null,[l("td",ke,[e(_,{class:"mb-3",style:{"font-size":"30px",color:"grey"}},{default:t(()=>[c("mdi-file-document-alert-outline")]),_:1}),xe,c(" No records found ")])])]))])]),l("div",Ce,[e(U,{color:"primary",size:"medium",flat:"",class:"text-none mt-3 p-2",onClick:o[4]||(o[4]=r=>b.value=!b.value)},{default:t(()=>[e(_,{class:"mr-3"},{default:t(()=>[c("mdi-database-cog")]),_:1}),c(" Select Item ")]),_:1}),e(Z,{modelValue:b.value,"onUpdate:modelValue":o[7]||(o[7]=r=>b.value=r),class:"d-flex align-items-center justify-content-center","location-strategy":"connected"},{default:t(()=>[e(V,{class:"pa-7","min-height":"500",width:"700"},{default:t(()=>[e(f,null,{default:t(()=>[e(p,{cols:"4"},{default:t(()=>[e(g,{modelValue:y.search,"onUpdate:modelValue":o[5]||(o[5]=r=>y.search=r),clearable:"",density:"compact",label:"Search all fields",variant:"outlined",color:"primary"},null,8,["modelValue"])]),_:1}),e(X),e(U,{onClick:o[6]||(o[6]=r=>b.value=!1),icon:"",variant:"plain",color:"primary"},{default:t(()=>[e(_,null,{default:t(()=>[c("mdi-close")]),_:1})]),_:1})]),_:1}),e(F(ae),{ref_key:"datatable",ref:B,rows:I.value,columns:F(D),loading:x.value,selectRowOnClick:!0,sortable:!0,search:y.search,isServerMode:!0,totalRows:z.value,pageSize:y.pagesize,hide:!0,filter:!0,skin:"bh-table-compact bh-table-bordered bh-table-responsive",class:"",onRowClick:Q,onChange:G},null,8,["rows","columns","loading","search","totalRows","pageSize"]),e(Y),l("p",we,[Se,Ue,i.value.spareparts.length>0?(m(),h("span",Re,[(m(!0),h(N,null,q(i.value.spareparts,(r,u)=>(m(),h("span",{key:r.id},[c(" [ "+k(r.item_code)+" - ",1),e(_,{onClick:a=>P(u),class:"text-danger"},{default:t(()=>[c("mdi-trash-can-outline")]),_:2},1032,["onClick"]),c("] Â  ")]))),128))])):(m(),h("span",Ne,"No data selected"))])]),_:1})]),_:1},8,["modelValue"])])]}),_:1})]),_:1})]),_:1})]),_:1},512)}}};export{Me as _};
