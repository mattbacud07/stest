import{ap as Q,J as x,aI as Y,aK as Z,P as D,e as m,o,f as b,w as e,h as n,k as t,t as a,n as h,I as N,p as _,F as J,z as j,j as c,Q as tt,x as et,r as st,y as at}from"./index-BFEiEqzV.js";import"./lodash-ByxqToh2.js";const nt=t("p",null,"Delegated to",-1),ot={class:"text-grey-darken-1"},lt=t("p",null,"Date of delegation",-1),ct={class:"text-grey-darken-1"},dt=t("p",null,[c("Date Accepted "),t("span",{class:"small text-disabled"},"(yyyy-mm-dd)")],-1),rt={class:"text-grey-darken-1"},it=t("p",null,[c("In Transit "),t("span",{class:"small text-disabled"},"(yyyy-mm-dd)")],-1),_t={class:"text-grey-darken-1"},ut=t("p",null,"Travel Duration",-1),pt={class:"text-grey-darken-1"},mt=t("p",null,[c("Start date "),t("span",{class:"small text-disabled"},"(yyyy-mm-dd)")],-1),ht={class:"text-grey-darken-1"},yt=t("p",null,[c("End date "),t("span",{class:"small text-disabled"},"(yyyy-mm-dd)")],-1),vt={class:"text-grey-darken-1"},ft=t("p",{class:"font-weight-bold"},"History logs: ",-1),gt=t("i",{class:"text-small text-disabled subtitle"}," (Click to show details per log)",-1),bt={class:"d-flex justify-content-between"},kt=t("b",{class:"bg-grey-lighten-3 pa-1 rounded"},"Servicing Activities:",-1),xt=t("b",{class:"bg-grey-lighten-3 pa-1 rounded"},"Actions Taken:",-1),$t=t("b",{class:"bg-grey-lighten-3 pa-1 rounded"},"Spareparts Used:",-1),St=t("b",{class:"bg-grey-lighten-3 pa-1 rounded"},"Items Acquired:",-1),At=t("p",null,"Assigned to:",-1),wt={class:"mt-2"},Dt={class:"text-grey"},Nt={key:0,class:"mb-3 mt-4"},Tt=t("p",{class:"text-primary font-weight-medium"},"Remarks:",-1),Ct={class:"text-remarks"},It={key:1,class:"mb-3 mt-4"},Rt=t("p",null,[t("b",null,"Status after service:")],-1),qt={class:"text-remarks"},Ft={class:"mt-3"},Mt=t("p",{class:"text-center text-grey"},"No history logs found",-1),oe={__name:"InternalServicingActivity",props:{internalData:{type:Object,default:()=>({})}},setup(y){const A=y,{internalData:k}=Q(A),u=x(()=>{var s;return((s=k.value)==null?void 0:s.task_delegation)||{}}),$=x(()=>{var s;return(s=k.value)==null?void 0:s.task_delegation_all}),T=s=>x(()=>D(u.value[s])||"---"),C=x(()=>{var s,p;return((s=u.value)==null?void 0:s.type)===Y||((p=u.value)==null?void 0:p.type)===Z}),w=T("created_at"),S=T("acted_at"),I=x(()=>{var p,d,i;const s=(i=(d=(p=u.value)==null?void 0:p.task_activity)==null?void 0:d.find(v=>v.status==="In Transit"))==null?void 0:i.acted_at;return D(s)}),R=x(()=>{var p,d,i;const s=(i=(d=(p=u.value)==null?void 0:p.task_activity)==null?void 0:d.find(v=>v.status==="Started"))==null?void 0:i.acted_at;return D(s)}),l=x(()=>{var p,d,i;const s=(i=(d=(p=u.value)==null?void 0:p.task_activity)==null?void 0:d.find(v=>v.status==="Ended"))==null?void 0:i.acted_at;return D(s)});return(s,p)=>{const d=m("v-col"),i=m("v-row"),v=m("v-divider"),U=m("v-btn"),q=m("v-card"),H=m("v-dialog"),P=m("v-icon"),K=m("v-chip");return o(),b(q,{class:"pa-3"},{default:e(()=>[n(i,null,{default:e(()=>[n(d,{cols:"12",lg:"4",md:"4",sm:"6"},{default:e(()=>{var f,r;return[nt,t("p",ot,a(((f=u.value)==null?void 0:f.first_name)??"--")+" "+a(((r=u.value)==null?void 0:r.last_name)??"--"),1)]}),_:1}),n(d,{cols:"12",lg:"4",md:"4",sm:"6"},{default:e(()=>[lt,t("p",ct,a(h(w)??"---"),1)]),_:1})]),_:1}),n(i,null,{default:e(()=>[n(d,{cols:"12",lg:"4",md:"4",sm:"6"},{default:e(()=>[dt,t("p",rt,a(h(S)??"---"),1)]),_:1}),C.value?(o(),b(d,{key:0,cols:"12",lg:"4",md:"4",sm:"6"},{default:e(()=>[it,t("p",_t,a(I.value??"---"),1)]),_:1})):N("",!0),C.value?(o(),b(d,{key:1,cols:"12",lg:"4",md:"4",sm:"6"},{default:e(()=>{var f;return[ut,t("p",pt,a(((f=u.value)==null?void 0:f.travel_duration)??"---"),1)]}),_:1})):N("",!0),n(d,{cols:"12",lg:"4",md:"4",sm:"6"},{default:e(()=>[mt,t("p",ht,a(R.value??"---"),1)]),_:1}),n(d,{cols:"12",lg:"4",md:"4",sm:"6"},{default:e(()=>[yt,t("p",vt,a(l.value??"---"),1)]),_:1})]),_:1}),n(v,{class:"mt-7 mb-7"}),n(i,{class:"mt-5"},{default:e(()=>[ft,gt,n(d,{cols:"12",lg:"12",md:"12",sm:"12"},{default:e(()=>{var f;return[((f=$.value)==null?void 0:f.length)>0?(o(!0),_(J,{key:0},j($.value,(r,L)=>(o(),b(q,{elevation:"0",class:"mt-3",key:L},{default:e(()=>[t("div",bt,[n(H,{activator:"parent","max-width":"800",scrollable:""},{default:e(({isActive:W})=>[n(q,{class:"pl-4 pr-4 pt-3"},{actions:e(()=>[n(U,{class:"ml-auto position-fixed bottom-0",text:"Close",onClick:F=>W.value=!1},null,8,["onClick"])]),default:e(()=>{var F,V,z,E;return[t("div",null,[t("pre",null,[kt,c(" "+a(JSON.stringify((F=r.task_activity)==null?void 0:F.map(g=>({status:g.status,acted_at:tt(g.acted_at)})),null,2)),1)])]),t("div",null,[t("pre",null,[xt,c(" "+a(JSON.stringify((V=r.actions_taken)==null?void 0:V.map(({action:g})=>({action:g})),null,2)),1)])]),t("div",null,[t("pre",null,[$t,c(" "+a(JSON.stringify((z=r.spareparts)==null?void 0:z.map(({item_id:g,qty:M,dr:O,si:G,remarks:X})=>({item_id:g,qty:M,dr:O,si:G,remarks:X})),null,2)),1)])]),t("div",null,[t("pre",null,[St,c(" "+a(JSON.stringify((E=r.items_acquired)==null?void 0:E.map(({item:g,qty:M,remarks:O})=>({item:g,qty:M,remarks:O})),null,2)),1)])])]}),_:2},1024)]),_:2},1024),t("div",null,[At,t("div",wt,[t("strong",Dt,[n(P,{class:"small text-disabled"},{default:e(()=>[c("mdi-account")]),_:1}),c(" "+a(r.assigned_to),1)]),r.remarks?(o(),_("div",Nt,[Tt,t("p",Ct,a(r.remarks),1)])):N("",!0),r.status_after_service?(o(),_("div",It,[Rt,t("p",qt,a(r.status_after_service),1)])):N("",!0),t("div",Ft,[n(K,{color:"warning",size:"small",variant:"tonal",label:""},{default:e(()=>[n(P,{icon:"mdi-chevron-right"}),c(" Â  "+a(r==null?void 0:r.status),1)]),_:2},1024)])])]),t("div",null,[t("p",null,a(D(r.created_at)),1)])]),$.value.length>1?(o(),b(v,{key:0})):N("",!0)]),_:2},1024))),128)):(o(),b(i,{key:1,class:"mt-1"},{default:e(()=>[Mt]),_:1}))]}),_:1})]),_:1})]),_:1})}}},Ot=t("p",{class:"mb-3"},[t("b",{class:"text-grey"},"Actions Taken")],-1),Jt={class:"mt-3"},jt={key:1},Bt={class:"mt-3"},Pt=t("span",{class:"text-grey small"},"No records found",-1),Vt=t("p",{class:"mb-3"},[t("b",{class:"text-grey"},"Status after service")],-1),zt={key:1},Et=t("p",{class:"mb-3"},[t("b",{class:"text-grey"},"Remarks")],-1),Qt={key:0},Ut={key:1},Ht={class:"table-responsive sparepartsField"},Kt=t("p",{class:"mb-3"},[t("b",{class:"text-grey"},"Reagents / Spare Parts Used")],-1),Lt={class:"table table-sm table-bordered table-responsive"},Wt=t("thead",{style:{background:"#afafaf2e"}},[t("tr",null,[t("th",{scope:"col"},"Item Code"),t("th",{scope:"col"},"Item Description"),t("th",null,"Qty"),t("th",null,"DR#"),t("th",null,"SI#"),t("th",null,"Remarks"),t("th")])],-1),Gt={key:0},Xt={colspan:"2"},Yt={key:1},Zt={colspan:"7",class:"text-center p-3",style:{opacity:".3"}},te=t("br",null,null,-1),le={__name:"ServiceReportData",props:{task_delegation:{type:Object,default:()=>({})},actions_taken:{type:Array,default:()=>[]},spareparts:{type:Array,default:()=>[]}},setup(y){const A=y,{task_delegation:k,actions_taken:u,spareparts:$}=Q(A);return(T,C)=>{const w=m("v-icon"),S=m("v-col"),I=m("v-chip"),R=m("v-row");return o(),b(R,null,{default:e(()=>[n(S,{cols:"12"},{default:e(()=>{var l;return[Ot,((l=h(u))==null?void 0:l.length)>0?(o(!0),_(J,{key:0},j(h(u),s=>(o(),_("p",{key:s},[t("span",Jt,[n(w,{color:"primary"},{default:e(()=>[c("mdi-check")]),_:1}),c(" "+a(s.action),1)])]))),128)):(o(),_("p",jt,[t("span",Bt,[n(w,{color:"grey"},{default:e(()=>[c("mdi-text-box-search-outline")]),_:1}),c(),Pt])]))]}),_:1}),n(S,{cols:"12"},{default:e(()=>{var l;return[Vt,(l=h(k))!=null&&l.status_after_service?(o(),b(I,{key:0,label:"",density:"comfortable",color:"primary",variant:"tonal"},{default:e(()=>{var s;return[c(a((s=h(k))==null?void 0:s.status_after_service),1)]}),_:1})):(o(),_("p",zt,"---"))]}),_:1}),n(S,{cols:"12"},{default:e(()=>{var l,s;return[Et,(l=h(k))!=null&&l.remarks?(o(),_("p",Qt,a((s=h(k))==null?void 0:s.remarks),1)):(o(),_("p",Ut,"---"))]}),_:1}),n(S,{cols:"12"},{default:e(()=>[t("div",Ht,[Kt,t("table",Lt,[Wt,h($).length>0?(o(),_("tbody",Gt,[(o(!0),_(J,null,j(h($),(l,s)=>(o(),_("tr",{key:l.id},[t("td",null,a(l.equipment.item_code),1),t("td",null,a(l.equipment.description),1),t("td",null,a(l.qty),1),t("td",null,a(l.dr),1),t("td",null,a(l.si),1),t("td",Xt,a(l.remarks),1)]))),128))])):(o(),_("tbody",Yt,[t("tr",null,[t("td",Zt,[n(w,{class:"mb-3",style:{"font-size":"50px"}},{default:e(()=>[c("mdi-file-document-alert-outline")]),_:1}),te,c(" No records found ")])])]))])])]),_:1})]),_:1})}}},ee=et(),B=st([]),se=async()=>{try{const y=await ee.get("getStandardActions");y.data&&y.data.actions&&(B.value=y.data.actions.map(A=>A.actions))}catch(y){console.error("Failed to fetch standard actions:",y)}},ce=()=>(at(()=>{B.value.length||se()}),{actions_data:B});export{oe as _,le as a,ce as u};
