import{x as J,r as d,E as q,y as A,f as I,w as e,o as y,h as t,j as i,n as h,k as p,G as S,t as b,p as L,I as T,e as s,Q as U}from"./index-BFEiEqzV.js";import{d as E}from"./debounce-Ciq6Vdb9.js";import{g as F}from"./vue3-datatable-4DUKYgRc.js";import{B as $}from"./BaseLayout-qpe1goZP.js";import"./topBarUserProfile-DObMqA0B.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={key:0},Y={__name:"ServiceLogs",setup(G){const N=J(),V=d(null),m=d(!0),C=d(0),a=q({current_page:1,pagesize:10,sort_column:"id",sort_direction:"desc",search:""}),w=d(null),O=d([{field:"id",title:"ID",isUnique:!0,type:"number",hide:!1},{field:"model",title:"Model",hide:!1},{field:"model_name",title:"Module Name",hide:!1},{field:"model_id",title:"Model ID",hide:!1},{field:"action",title:"Action",hide:!1},{field:"changes",title:"Changes",hide:!1},{field:"original",title:"Original",hide:!1},{field:"user",title:"User",hide:!1},{field:"created_at",title:"Created At",hide:!1}])||[],u=async()=>{var l;try{m.value=!0;const n=await N.get("get_logs",{params:{...a}});if((l=n.data)!=null&&l.logs){const _=n.data.logs;w.value=_.data,C.value=_.total}}catch(n){console.log(n)}m.value=!1},z=()=>{u()},B=E(u,300),D=l=>{a.current_page=l.current_page,a.pagesize=l.pagesize,a.sort_column=l.sort_column,a.sort_direction=l.sort_direction,l.change_type==="search"?B():u()};return A(()=>{u()}),(l,n)=>{const _=s("v-text-field"),x=s("v-col"),f=s("v-icon"),v=s("v-tooltip"),c=s("v-btn"),M=s("v-row"),g=s("v-card"),k=s("v-dialog");return y(),I($,null,{default:e(()=>[t(g,{class:"pa-5"},{default:e(()=>[t(M,{class:"mb-3"},{default:e(()=>[t(x,{cols:"12",md:"6",sm:"6"},{default:e(()=>[t(_,{modelValue:a.search,"onUpdate:modelValue":n[0]||(n[0]=o=>a.search=o),label:"Search",density:"compact","single-line":"",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"6",sm:"6"},{default:e(()=>[t(c,{dense:"",variant:"plain",onClick:z},{default:e(()=>[t(f,null,{default:e(()=>[i("mdi-refresh")]),_:1}),t(v,{activator:"parent",location:"bottom"},{default:e(()=>[i("Refresh Table")]),_:1})]),_:1})]),_:1})]),_:1}),t(h(F),{ref_key:"datatable",ref:V,rows:w.value,columns:h(O),loading:m.value,search:a.search,isServerMode:!0,totalRows:C.value,pageSize:a.pagesize,onChange:D,columnFilter:!1,sortColumn:a.sort_column,sortDirection:a.sort_direction,sortable:!0,style:{border:"1px solid #99999926","border-radius":"3px"},skin:"bh-table-compact bh-table-bordered bh-table-striped bh-table-hover",hasCheckbox:!0,selectRowOnClick:!0,cellClass:"internalCell"},{changes:e(o=>[p("div",null,[t(k,{"max-width":"700"},{activator:e(({props:r})=>[t(c,S(r,{dense:"",variant:"plain"}),{default:e(()=>[t(f,null,{default:e(()=>[i("mdi-eye-arrow-left-outline")]),_:1}),t(v,{activator:"parent",location:"bottom"},{default:e(()=>[i("Click to View Original Data")]),_:1})]),_:2},1040)]),default:e(({isActive:r})=>[t(g,{class:"pa-5"},{default:e(()=>[p("pre",null,b(JSON.stringify(JSON.parse(o.value.changes),null,2)),1)]),actions:e(()=>[t(c,{class:"ml-auto text-none",text:"Close",onClick:R=>r.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1024)])]),original:e(o=>[o.value.original!==null?(y(),L("div",j,[t(k,{"max-width":"700"},{activator:e(({props:r})=>[t(c,S(r,{dense:"",variant:"plain"}),{default:e(()=>[t(f,null,{default:e(()=>[i("mdi-eye-arrow-left-outline")]),_:1}),t(v,{activator:"parent",location:"bottom"},{default:e(()=>[i("Click to View Changes")]),_:1})]),_:2},1040)]),default:e(({isActive:r})=>[t(g,{class:"pa-5"},{default:e(()=>[p("pre",null,b(JSON.stringify(JSON.parse(o.value.original),null,2)),1)]),actions:e(()=>[t(c,{class:"ml-auto text-none",text:"Close",onClick:R=>r.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1024)])):T("",!0)]),created_at:e(o=>[p("span",null,b(h(U)(o.value.created_at)),1)]),_:1},8,["rows","columns","loading","search","totalRows","pageSize","sortColumn","sortDirection"])]),_:1})]),_:1})}}};export{Y as default};
