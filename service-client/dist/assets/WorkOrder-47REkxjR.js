import{d as Me,s as Ne,u as Be,c as Te,v as Fe,r,A as F,D as $e,a3 as je,x as He,f as ve,w as o,i as We,e as c,o as u,h as e,n as d,y as $,F as j,j as n,m as w,t as g,H as le,k as s,a2 as Ye,a4 as Qe,I as Ge,L as Je,M as Ke}from"./index-C8ph-EQq.js";import{O as Xe}from"./main-Z0aCj2Rp.js";import{L as Ze}from"./LayoutSinglePage-CszXxlTG.js";import{g as we}from"./vue3-datatable-BuM4cnvr.js";/* empty css              */import{d as el}from"./debounce-VX6vs7ks.js";import{_ as ll}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./topBarUserProfile-ExGO6QtX.js";import"./logout-D7B5usQQ.js";const f=H=>(Je("data-v-b4a7a30f"),H=H(),Ke(),H),tl={key:0,class:"text-danger"},al=f(()=>s("h5",{class:"mb-1",style:{"font-weight":"500",color:"#191970"}},"Other Request Details",-1)),ol=f(()=>s("h5",{class:"mb-2",style:{"font-weight":"500",color:"#191970"}},"External Request",-1)),sl=f(()=>s("h5",{class:"mb-2",style:{"font-weight":"500",color:"#191970"}},"Internal Request",-1)),rl=f(()=>s("h5",{class:"p-3",style:{"font-weight":"500",color:"#191970"}},"EQUIPMENT & PERIPHERALS",-1)),nl={class:"table-responsive"},ul={class:"table table-sm table-bordered"},dl=f(()=>s("thead",{style:{background:"#afafaf2e"}},[s("tr",null,[s("th",{scope:"col"},"Item Code"),s("th",{scope:"col"},"Item Description"),s("th",{scope:"col"},"Serial Number"),s("th",{scope:"col"},"Remarks"),s("th",{scope:"col"})])],-1)),il={key:0},cl={key:1},ml={colspan:"5",class:"text-center p-1",style:{opacity:".2"}},pl=f(()=>s("br",null,null,-1)),vl={class:"d-flex justify-content-center"},fl={class:"text-danger"},_l=f(()=>s("b",null,"List of Selected Row",-1)),hl=f(()=>s("br",null,null,-1)),bl={key:0},yl={key:1,class:"small"},gl={class:"p-3 mt-2",style:{"font-weight":"500",color:"#191970"}},kl={style:{"font-size":".8em","font-weight":"400",color:"#777"}},Vl={key:0},wl={class:"table-responsive"},xl={class:"table table-sm table-bordered table-responsive"},Rl=f(()=>s("thead",{style:{background:"#afafaf2e"}},[s("tr",null,[s("th",{scope:"col"},"Item Code"),s("th",{scope:"col"},"Item Description"),s("th",{scope:"col"},"Remarks"),s("th",{scope:"col"})])],-1)),Cl={key:0},Sl={key:1},ql={colspan:"5",class:"text-center p-3",style:{opacity:".3"}},Il=f(()=>s("br",null,null,-1)),Dl={class:"d-flex justify-content-center"},Ul={class:"text-danger"},El=f(()=>s("b",null,"List of Selected Row",-1)),Pl=f(()=>s("br",null,null,-1)),zl={key:0},Ol={key:1,class:"small"},Al={__name:"WorkOrder",setup(H){const O=Me.useToast(),{name:Ll,width:I}=Ne(),te=Be(),W=Te();W.getUserData;const ae=Fe(),fe=r(null),oe=r(!1),A=r(!1),D=r(!1);r(!1);const _e=r(!1),L=r(!1),R=r(!1),he=r([]);r("");const Y=r(""),xe=[{title:"Back",disabled:!1,href:"/equipment-handling",display:"block"},{title:"Equipment Handling",disabled:!0,href:"",display:"none"},{title:"Work Order",disabled:!0,href:"",display:"none"}],Re=l=>{!l.disabled&&l.href&&te.push(l.href)},k=r(6);F(I,l=>{l<550?k.value=12:l<768?M.value.forEach(a=>{a.field==="description"&&(a.hide=!0)}):(k.value=6,M.value.forEach(a=>{a.field==="description"&&(a.hide=!1)}))});const se=r(""),Q=r(""),re=r(""),G=r(""),ne=r(""),J=r(""),ue=r(""),U=r(null),E=r(null),C=r("");r("");const K=r(""),X=r(""),de=r(""),b=r({ruleInternal:[l=>!!l||"Choose one option"],ruleExternal:[l=>!!l||"Choose one option"],ruleInstitution:[l=>!!l||"Required field",l=>l.key!==void 0?!0:"Select one of the options listed",l=>l.value!==void 0?!0:"Select one of the options listed"],ruleAddress:[l=>!!l||"Address is required"],ruleRequestedBy:[l=>!!l||"Field is required"],ruleEquipmentSerial:[l=>!!l||"Required"],otherRule:[l=>!!l||"Required"]});F(U,l=>{l!==null?(E.value=null,b.value.ruleExternal=[],L.value=!0,K.value="",X.value="",J.value=""):L.value=!1,l!==12&&(C.value="")}),F(E,l=>{l!==null&&(U.value=null,b.value.ruleInternal=[]),l!==6&&(C.value="")}),se.value=W.user.first_name+" "+W.user.last_name,F(Q,l=>{re.value=l?l.value:""}),r(5);const Ce=async()=>{const l=Array.from(S.value),a=Array.from(V.value),i=Ye(G.value).format("YYYY-MM-DD");R.value=!0;const{valid:N}=await oe.value.validate();if(!N){O.error("Please ensure that required fields are not left blank"),R.value=!1;return}if(!G.value)Y.value="Required field",setTimeout(()=>{Y.value=""},3e3),O.error("Please enter the proposed delivery date"),R.value=!1;else if(!V.value||V.value.length===0)O.error("Please select at least one record to proceed"),R.value=!1;else try{const q=await ae.post("submit-work-order",{requested_by:W.user.id,institution:Q.value.institutionId,proposed_delivery_date:i,with_contract:X.value,attach_gate:K.value,ship:ue.value,bypass:J.value,ocular:ne.value,request_type:E.value??U.value,other:C.value,endorsement:de.value,equipments:a,peripherals:l});q.data&&q.data.success?(O.success("Request successfully created"),_e.value=!0,te.push("/equipment-handling")):O.error("Something went wrong")}catch(q){console.log(q)}finally{R.value=!1}},P=r(!0),ie=r(0),M=r([{field:"id",title:"ID",isUnique:!0,type:"number",hide:!0},{field:"item_code",title:"Item Code"},{field:"description",title:"Item Description"},{field:"name",title:"Category"}])||[],Se=M.value.map(l=>l.field),p=$e({current_page:1,pagesize:10,search:""}),ce=r(null),V=r([]),S=r([]),qe=l=>{V.value.push({id:l.id,item_code:l.item_code,description:l.description,equipmentSerial:"",equipmentRemark:""})},Ie=l=>{S.value.push({id:l.id,item_code:l.item_code,description:l.description,peripheralSerial:"",peripheralRemark:""})},be=l=>{V.value.splice(l,1)},ye=l=>{S.value.splice(l,1)},me=r([]);F(D,async l=>{l===!0?me.value=[1,5,7]:me.value=[],p.search="",await Z()});const Z=async()=>{try{P.value=!0;const a=(await ae.get("master-data-equipments",{params:{...p,searchColumn:Se,item_category:me.value}})).data.equipments;ce.value=a.data,ie.value=a.total}catch(l){console.log(l)}P.value=!1},De=async()=>{try{P.value=!0;const l=await ae.get("get_institution");he.value=l.data.institutions.map(a=>({key:a.name,value:a.address,institutionId:a.id}))}catch(l){console.log(l)}P.value=!1},Ue=el(Z,300),ge=l=>{p.current_page=l.current_page,p.pagesize=l.pagesize,p.search=l.search,l.change_type==="search"?Ue():Z()},Ee=()=>{k.value=I.value<550?12:6};je(async(l,a,i)=>{const{valid:N}=await oe.value.validate();N||window.confirm("Discard Changes?")?i():i(!1)});const Pe=()=>{te.push("/equipment-handling")};return He(()=>{Z(),De(),Ee()}),(l,a)=>{const i=c("v-icon"),N=c("v-breadcrumbs-item"),q=c("v-breadcrumbs"),m=c("v-col"),pe=c("v-spacer"),z=c("v-btn"),ze=c("v-combobox"),_=c("v-text-field"),x=c("v-row"),ee=c("v-divider"),B=c("v-checkbox"),Oe=c("v-textarea"),v=c("v-radio"),ke=c("v-radio-group"),T=c("v-card"),Ve=c("v-overlay"),Ae=c("v-container"),Le=c("v-form");return u(),ve(Le,{onSubmit:We(Ce,["prevent"]),ref_key:"form",ref:oe},{default:o(()=>[e(Ze,null,{topBarFixed:o(()=>[e(m,{lg:"6",md:"6",sm:"8",cols:"8"},{default:o(()=>[e(q,{class:"pt-7"},{default:o(()=>[(u(),d(j,null,$(xe,(t,h)=>e(N,{key:h,class:Qe({"custom-pointer":!t.disabled}),style:Ge({display:w(I)<=768?t.display:""}),onClick:y=>Re(t),disabled:t.disabled},{default:o(()=>[n(g(t.title)+" ",1),e(i,{class:"ml-1",icon:"mdi-chevron-right"})]),_:2},1032,["class","style","onClick","disabled"])),64))]),_:1})]),_:1}),e(pe),e(m,{lg:"6",md:"6",sm:"4",cols:"4","align-self":"center",class:"d-flex justify-end"},{default:o(()=>[e(z,{disabled:R.value,onClick:Pe,color:"primary",variant:"tonal",class:"text-none mr-2"},{default:o(()=>[n(" Cancel ")]),_:1},8,["disabled"]),e(z,{type:"submit",loading:R.value,disabled:_e.value,color:"primary",variant:"flat",class:"text-none btnSubmit"},{default:o(()=>[e(i,{class:"mr-2"},{default:o(()=>[n("mdi-note-plus-outline")]),_:1}),n(" Create ")]),_:1},8,["loading","disabled"])]),_:1})]),default:o(()=>[e(Ae,{class:"container-form mt-10"},{default:o(()=>[e(T,{class:"p-2 border-sm pt-7 border-dashed",elevation:"0"},{default:o(()=>[e(x,null,{default:o(()=>[e(m,{cols:k.value},{default:o(()=>[e(ze,{color:"primary",modelValue:Q.value,"onUpdate:modelValue":a[0]||(a[0]=t=>Q.value=t),clearable:"",label:"Institution",density:"compact",items:he.value,variant:"outlined",itemValue:"value",itemTitle:"key",rules:b.value.ruleInstitution,"close-on-content-click":!1,"hide-details":""},null,8,["modelValue","items","rules"])]),_:1},8,["cols"]),e(m,{cols:k.value},{default:o(()=>[e(_,{color:"primary",density:"compact",label:"Requested by",placeholder:"Requested by",variant:"outlined",readonly:"",modelValue:se.value,"onUpdate:modelValue":a[1]||(a[1]=t=>se.value=t),rules:b.value.ruleRequestedBy,"hide-details":""},null,8,["modelValue","rules"])]),_:1},8,["cols"])]),_:1}),e(x,{class:"mb-2"},{default:o(()=>[e(m,{cols:k.value},{default:o(()=>[e(_,{color:"primary",modelValue:re.value,"onUpdate:modelValue":a[2]||(a[2]=t=>re.value=t),label:"Address",density:"compact",variant:"outlined",readonly:"","onUpdate:Item":"(newVal) => { address.value = newVal.key }",rules:b.value.ruleAddress,"hide-details":""},null,8,["modelValue","rules"])]),_:1},8,["cols"]),e(m,{cols:k.value},{default:o(()=>[e(w(Xe),{modelValue:G.value,"onUpdate:modelValue":a[3]||(a[3]=t=>G.value=t),"auto-apply":"","min-date":new Date,"enable-time-picker":!1,placeholder:"Propose Delivery Date"},null,8,["modelValue","min-date"]),Y.value!==""?(u(),d("p",tl,g(Y.value),1)):le("",!0)]),_:1},8,["cols"])]),_:1}),e(ee),e(x,{class:"mt-3"},{default:o(()=>[e(m,{cols:k.value},{default:o(()=>[al,e(B,{modelValue:ne.value,"onUpdate:modelValue":a[4]||(a[4]=t=>ne.value=t),color:"primary",label:"Request for Ocular",value:"1",class:"vCheckbox",density:"compact"},null,8,["modelValue"]),e(B,{modelValue:J.value,"onUpdate:modelValue":a[5]||(a[5]=t=>J.value=t),color:"primary",label:"Bypass Internal Servicing Procedures",value:"1",class:"vCheckbox",disabled:L.value,density:"compact"},null,8,["modelValue","disabled"]),e(B,{modelValue:ue.value,"onUpdate:modelValue":a[6]||(a[6]=t=>ue.value=t),color:"primary",label:"Ship & Deliver direct to customer immediately",class:"vCheckbox",value:"1",density:"compact"},null,8,["modelValue"])]),_:1},8,["cols"]),e(m,{cols:k.value},{default:o(()=>[e(Oe,{color:"primary",label:"Endorsement",modelValue:de.value,"onUpdate:modelValue":a[7]||(a[7]=t=>de.value=t),"row-height":"25",rows:"3",variant:"outlined","auto-grow":"",shaped:""},null,8,["modelValue"])]),_:1},8,["cols"])]),_:1}),e(ee,{class:"mb-3"}),e(x,{class:"mt-3"},{default:o(()=>[e(m,{cols:"12",md:"6",sm:"6"},{default:o(()=>[ol,e(ke,{modelValue:E.value,"onUpdate:modelValue":a[8]||(a[8]=t=>E.value=t),rules:b.value.ruleExternal,column:"",density:"compact"},{default:o(()=>[e(v,{color:"primary",label:"For Demonstration",value:"1"}),e(v,{color:"primary",label:"Reagent Tie-up",value:"2"}),e(v,{color:"primary",label:"Purchased",value:"3"}),e(v,{color:"primary",label:"Shipment / Delivery",value:"4"}),e(v,{color:"primary",label:"Service Unit",value:"5"}),e(v,{color:"primary",label:"Other",value:"6"})]),_:1},8,["modelValue","rules"]),E.value==="6"?(u(),ve(_,{key:0,density:"compact",variant:"outlined",placeholder:"Other External Request","w-90":"",modelValue:C.value,"onUpdate:modelValue":a[9]||(a[9]=t=>C.value=t),rules:b.value.otherRule},null,8,["modelValue","rules"])):le("",!0),e(B,{modelValue:K.value,"onUpdate:modelValue":a[10]||(a[10]=t=>K.value=t),disabled:L.value,class:"vCheckbox",color:"primary",label:"Attached gate/entry pass",value:"1"},null,8,["modelValue","disabled"]),e(B,{modelValue:X.value,"onUpdate:modelValue":a[11]||(a[11]=t=>X.value=t),disabled:L.value,class:"vCheckbox",color:"primary",label:"with contract/other docs",value:"1"},null,8,["modelValue","disabled"])]),_:1}),e(m,{cols:"12",md:"6",sm:"6"},{default:o(()=>[sl,e(ke,{modelValue:U.value,"onUpdate:modelValue":a[12]||(a[12]=t=>U.value=t),rules:b.value.ruleInternal,column:"",density:"compact"},{default:o(()=>[e(v,{color:"primary",label:"For Corrective",value:"7"}),e(v,{color:"primary",label:"For Refurbishment",value:"8"}),e(v,{color:"primary",label:"For Quality Control",value:"9"}),e(v,{color:"primary",label:"Training Purposes",value:"10"}),e(v,{color:"primary",label:"For Disposal",value:"11"}),e(v,{color:"primary",label:"Other",value:"12"})]),_:1},8,["modelValue","rules"]),U.value==="12"?(u(),ve(_,{key:0,density:"compact",variant:"outlined",placeholder:"Other External Request","w-90":"",modelValue:C.value,"onUpdate:modelValue":a[13]||(a[13]=t=>C.value=t),rules:b.value.otherRule},null,8,["modelValue","rules"])):le("",!0)]),_:1})]),_:1})]),_:1}),e(T,{class:"mt-3 p-3",elevation:"0",style:{border:"1px dashed #191970"}},{default:o(()=>[e(x,null,{default:o(()=>[rl,e(m,{cols:"12"},{default:o(()=>[s("div",nl,[s("table",ul,[dl,V.value.length>0?(u(),d("tbody",il,[(u(!0),d(j,null,$(V.value,(t,h)=>(u(),d("tr",{key:h},[s("td",null,[n(g(t.item_code)+" ",1),e(_,{class:"hideID"},{default:o(()=>[n(g(t.id),1)]),_:2},1024)]),s("td",null,g(t.description),1),s("td",null,[e(_,{clearable:"",density:"compact",variant:"plain",placeholder:"Serial number ....","w-100":"",modelValue:t.equipmentSerial,"onUpdate:modelValue":y=>t.equipmentSerial=y,rules:b.value.ruleEquipmentSerial},null,8,["modelValue","onUpdate:modelValue","rules"])]),s("td",null,[e(_,{clearable:"",density:"compact",variant:"plain",placeholder:"Remarks...","w-100":"",modelValue:t.equipmentRemark,"onUpdate:modelValue":y=>t.equipmentRemark=y},null,8,["modelValue","onUpdate:modelValue"])]),s("td",null,[e(i,{onClick:y=>be(h),class:"text-danger"},{default:o(()=>[n("mdi-trash-can-outline")]),_:2},1032,["onClick"])])]))),128))])):(u(),d("tbody",cl,[s("tr",null,[s("td",ml,[e(i,{class:"mb-3",style:{"font-size":"50px"}},{default:o(()=>[n("mdi-file-document-alert-outline")]),_:1}),pl,n(" No records found ")])])]))])]),s("div",vl,[e(z,{color:"primary",size:"medium",flat:"",class:"text-none mt-3 p-2",onClick:a[14]||(a[14]=t=>A.value=!A.value)},{default:o(()=>[e(i,{class:"mr-3"},{default:o(()=>[n("mdi-database-cog")]),_:1}),n(" Select Equipment & Peripherals ")]),_:1}),e(Ve,{modelValue:A.value,"onUpdate:modelValue":a[17]||(a[17]=t=>A.value=t),class:"d-flex align-items-center justify-content-center",width:w(I)<=600?400:600,"location-strategy":"connected"},{default:o(()=>[e(T,{class:"pa-7","min-height":"500"},{default:o(()=>[e(x,null,{default:o(()=>[e(m,{cols:"10",xl:"4",md:"4",sm:"5"},{default:o(()=>[e(_,{modelValue:p.search,"onUpdate:modelValue":a[15]||(a[15]=t=>p.search=t),clearable:"",density:"compact",label:"Search all fields",variant:"outlined",color:"primary"},null,8,["modelValue"])]),_:1}),e(pe),e(z,{onClick:a[16]||(a[16]=t=>A.value=!1),icon:"",variant:"plain",color:"primary"},{default:o(()=>[e(i,null,{default:o(()=>[n("mdi-close")]),_:1})]),_:1})]),_:1}),e(w(we),{ref_key:"datatable",ref:fe,rows:ce.value,columns:w(M),loading:P.value,selectRowOnClick:!0,sortable:!0,search:p.search,isServerMode:!0,totalRows:ie.value,pageSize:p.pagesize,hide:!0,filter:!0,skin:"bh-table-compact bh-table-bordered bh-table-responsive",class:"",onRowClick:qe,onChange:ge},null,8,["rows","columns","loading","search","totalRows","pageSize"]),e(ee),s("p",fl,[_l,hl,V.value.length>0?(u(),d("span",bl,[(u(!0),d(j,null,$(V.value,(t,h)=>(u(),d("span",{key:t.id},[n(" [ "+g(t.item_code)+" - ",1),e(i,{onClick:y=>be(h),class:"text-danger"},{default:o(()=>[n("mdi-trash-can-outline")]),_:2},1032,["onClick"]),n("]   ")]))),128))])):(u(),d("span",yl,"No data selected"))])]),_:1})]),_:1},8,["modelValue","width"])])]),_:1})]),_:1})]),_:1}),e(T,{class:"mt-3 p-3",elevation:"0",style:{border:".5px dashed #191970"}},{default:o(()=>[e(x,null,{default:o(()=>[s("h5",gl,[n("ADDITIONAL PERIPHERALS "),s("span",kl,[s("i",null,[w(I)<615?(u(),d("br",Vl)):le("",!0),n(" (Serial number to be filled by the IT Department)")])])]),e(m,{cols:"12"},{default:o(()=>[s("div",wl,[s("table",xl,[Rl,S.value.length>0?(u(),d("tbody",Cl,[(u(!0),d(j,null,$(S.value,(t,h)=>(u(),d("tr",{key:h},[s("td",null,[n(g(t.item_code)+" ",1),e(_,{class:"hideID"},{default:o(()=>[n(g(t.id),1)]),_:2},1024)]),s("td",null,g(t.description),1),s("td",null,[e(_,{clearable:"",density:"compact",variant:"plain",placeholder:"Remarks...","w-100":"",modelValue:t.peripheralRemark,"onUpdate:modelValue":y=>t.peripheralRemark=y},null,8,["modelValue","onUpdate:modelValue"])]),s("td",null,[e(i,{onClick:y=>ye(h),class:"text-danger"},{default:o(()=>[n("mdi-trash-can-outline")]),_:2},1032,["onClick"])])]))),128))])):(u(),d("tbody",Sl,[s("tr",null,[s("td",ql,[e(i,{class:"mb-3",style:{"font-size":"50px"}},{default:o(()=>[n("mdi-file-document-alert-outline")]),_:1}),Il,n(" No records found ")])])]))])]),s("div",Dl,[e(z,{color:"primary",size:"medium",flat:"",class:"text-none mt-3 p-2",onClick:a[18]||(a[18]=t=>D.value=!D.value)},{default:o(()=>[e(i,{class:"mr-3"},{default:o(()=>[n("mdi-database-plus")]),_:1}),n(" Select Additional Peripherals ")]),_:1}),e(Ve,{modelValue:D.value,"onUpdate:modelValue":a[21]||(a[21]=t=>D.value=t),class:"d-flex align-items-center justify-content-center",width:w(I)<=600?400:600,"location-strategy":"connected"},{default:o(()=>[e(T,{class:"pa-7","min-height":"600"},{default:o(()=>[e(x,null,{default:o(()=>[e(m,{cols:"10",xl:"4",md:"4",sm:"5"},{default:o(()=>[e(_,{modelValue:p.search,"onUpdate:modelValue":a[19]||(a[19]=t=>p.search=t),clearable:"",density:"compact",label:"Search all fields",variant:"outlined",color:"primary"},null,8,["modelValue"])]),_:1}),e(pe),e(z,{onClick:a[20]||(a[20]=t=>D.value=!1),icon:"",variant:"plain",color:"primary"},{default:o(()=>[e(i,null,{default:o(()=>[n("mdi-close")]),_:1})]),_:1})]),_:1}),e(w(we),{ref_key:"datatable",ref:fe,rows:ce.value,columns:w(M),loading:P.value,selectRowOnClick:!0,sortable:!0,hide:!0,search:p.search,isServerMode:!0,totalRows:ie.value,pageSize:p.pagesize,filter:!0,skin:"bh-table-compact bh-table-bordered",class:"",onRowClick:Ie,onChange:ge},null,8,["rows","columns","loading","search","totalRows","pageSize"]),e(ee),s("p",Ul,[El,Pl,S.value.length>0?(u(),d("span",zl,[(u(!0),d(j,null,$(S.value,(t,h)=>(u(),d("span",{key:t.id},[n(" [ "+g(t.item_code)+" - ",1),e(i,{onClick:y=>ye(h),class:"text-danger"},{default:o(()=>[n("mdi-trash-can-outline")]),_:2},1032,["onClick"]),n("]   ")]))),128))])):(u(),d("span",Ol,"No data selected"))])]),_:1})]),_:1},8,["modelValue","width"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)}}},Yl=ll(Al,[["__scopeId","data-v-b4a7a30f"]]);export{Yl as default};
