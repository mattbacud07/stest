import{L as F}from"./LayoutWithActions-lJJIN9jM.js";import{u as j,c as G,g as J,r as a,v as Q,D as X,P as y,A as Z,x as $,f as S,w as l,Q as K,R as ee,S as te,T as ae,U as se,C as le,o as c,h as _,m as r,H as oe,k as u,t as n,V as ne,W as re,X as ue,Y as ie,n as q,Z as ce,_ as de,$ as pe,a0 as me,a1 as E,I as _e,e as v,a2 as N}from"./index-C8ph-EQq.js";import{p as ve}from"./permitted-BzPEUTiR.js";import{g as fe}from"./vue3-datatable-BuM4cnvr.js";/* empty css              */import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./topBarUserProfile-ExGO6QtX.js";import"./logout-D7B5usQQ.js";const he={key:0,class:"text-danger"},Re={key:1,class:"text-success"},ye={key:2},qe={__name:"EquipmentHandling",setup(be){const A=j(),{can:d}=ve(),T=G(),f=J().currentUserRole,g=a(!0),b=a(null),D=a(null),V=a(null),L=Q(),h=a(!0),O=a(""),I=X({current_page:1,pagesize:10,sortColumn:"created_at",sortDirection:"desc"}),w=a(null),k=a([{field:"id",title:"Report Number",isUnique:!0,type:"number",hide:!1},{field:"name",title:"Institution",hide:!1},{field:"address",title:"Address",hide:!1},{field:"user_name",title:"Requested by"},{field:"request_type",title:"Request Category",hide:!1},{field:"request_name",title:"Type of Request",hide:!1},{field:"proposed_delivery_date",title:"Proposed Delivery Date",type:"date",hide:!1},{field:"final_installation_date",title:"Final Installation Date",type:"date",hide:!1},{field:"created_at",title:"Date Requested",type:"date",hide:!1},{field:"approver_name",title:"Pending Approval",hide:!1},{field:"main_status",title:"Status",type:"number",hide:!1}])||[];y("column",k);const Y=t=>{A.push({name:"WorkOrderApprover",params:{id:t.id}})},C=a([]),H=t=>{C.value=b.value.getSelectedRows(),t&&t.length===1?g.value=!1:g.value=!0;const o=t.map(i=>i.id),s=t.map(i=>i.status);D.value=o[0],V.value=s[0]},M=t=>C.value.map(s=>s.id).includes(t.id)?"highlightRow":"",p=a(""),P=a("WorkOrderApprover"),x=a(null);a(null),d("create","Equipment Handling")&&(x.value="WorkOrder");const B={selectedId:D,btnDisable:g,routeView:P,createRequest:x.value};y("data",B);const m=a(localStorage.getItem("myRequest")||!1);Z(m,t=>{R(),localStorage.setItem("myRequest",t)});const R=async()=>{var t;f===K&&(p.value=ee),f===te&&(p.value=ae),f===se&&(p.value=le);try{h.value=!0;const s=(await L.get("get-equipment-handling",{params:{user_id:T.user.id,category:p.value,myRequest:m.value}})).data.equipment_handling;w.value=s,O.value=(t=s==null?void 0:s.meta)==null?void 0:t.total}catch(o){console.log(o)}h.value=!1};return y("refresh",R),$(()=>{R()}),(t,o)=>{const s=v("v-checkbox"),i=v("v-col"),U=v("router-view"),W=v("v-card");return c(),S(F,null,{default:l(({searchText:z})=>[_(W,{class:"mx-auto"},{default:l(()=>[r(d)("approve","Equipment Handling")||r(d)("installer","Equipment Handling")||r(d)("delegate","Equipment Handling")?(c(),S(i,{key:0,class:"d-flex justify-content-end"},{default:l(()=>[_(s,{label:"View Submitted Request",modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=e=>m.value=e),value:"true"},null,8,["modelValue"])]),_:1})):oe("",!0),_(r(fe),{ref_key:"datatable",ref:b,class:"tableLimitText",rows:w.value,columns:r(k),loading:h.value,search:z,onRowSelect:H,columnFilter:!1,sortColumn:I.sortColumn,sortDirection:I.sortDirection,sortable:!0,noDataContent:"No records found",skin:"bh-table-compact bh-table-bordered bh-table-striped bh-table-hover",hasCheckbox:!0,rowClass:M,selectRowOnClick:!0,onRowDBClick:Y},{id:l(e=>[u("span",null,n(ne(e.value.id,e.value.created_at)),1)]),request_type:l(e=>[u("span",null,n(re(e.value.request_type)),1)]),request_name:l(e=>[u("span",null,n(ue(e.value.request_type,e.value.request_name,e.value.other)),1)]),approver_name:l(e=>[parseInt(e.value.main_status)===ie?(c(),q("span",he,"Disapproved")):parseInt(e.value.main_status)===ce?(c(),q("span",Re,"Completed")):(c(),q("span",ye,n(de(e.value.status))+" "+n(pe===e.value.status||me===e.value.status?e.value.ssu:""),1))]),main_status:l(e=>[u("span",{style:_e({color:E(e.value.main_status).color})},n(E(e.value.main_status).text),5)]),created_at:l(e=>[u("span",null,n(r(N)(e.value.created_at).format("MM-DD-YYYY")),1)]),final_installation_date:l(e=>[u("span",null,n(r(N)(e.value.final_installation_date).format("MM-DD-YYYY")),1)]),_:2},1032,["rows","columns","loading","search","sortColumn","sortDirection"]),_(U)]),_:2},1024)]),_:1})}}},Ae=ge(qe,[["__scopeId","data-v-3b28e663"]]);export{Ae as default};
