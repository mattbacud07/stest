import{a as q,g as D,u as N,c as O,r as R,J as P,ba as E,L as F,y as J,e as l,o as r,f as S,w as e,h as o,I as U,p as I,F as V,z as B,G as T,j as d,t as i,l as j,k as C,n as L}from"./index-BVXPU9zS.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H=[{name:"AdminDashboard",module:"Dashboard",icong:"mdi-tablet-dashboard"},{name:"#",module:"Account Management",icong:"mdi-account-multiple",children:[{name:"RolesMain",module:"Roles & Permission",icong:"mdi-account-badge"},{name:"ApprovalConfiguration",module:"Aprover Config",icong:"mdi-checkbox-multiple-outline"}]},{name:"#",module:"General Settings",icong:"mdi-file-document",children:[{name:"SetStandardActions",module:"Set Standard Actions",icong:"mdi-text-box-check-outline"},{name:"ChecklistItem",module:"Checklist Item",icong:"mdi-file-document-plus"}]},{name:"ServiceLogs",module:"General Logs",icong:"mdi-list-status"}],Y={__name:"BaseSidebar",setup(M){const g=q(),h=D(),_=h.currentUserRole,p=N(),b=O(),y=R(_),m=R([]),u=R(!1),a=()=>{h.setCurrentUserRole(y.value),g.buildAbility(),p.push("/",{replace:!0})},k=P(()=>{const w={module:"Dashboard",create:!0,read:!0,edit:!0,delete:!0,approve:!0,delegate:!0,installer:!0,report:!1,name:"dashboard",icong:"mdi-view-dashboard-variant"},n=m.value.find(t=>h.currentUserRole===t.role_id),v=[w];if(n){const t=JSON.parse(n==null?void 0:n.permissions),f=(t==null?void 0:t.filter(c=>c.read))||[];if(n.role_id===E)return[...H];if(n.role_id===F){let c=[];return c=f.filter(A=>b.user.approval_level.length>0&&A.module==="Equipment Handling"||b.user.approval_level_pullout.length>0&&A.module==="PullOut Request"),[...v,...c]}return[...v,...f]}});return J(()=>{m.value.push(...b.user.user_roles),u.value=m.value.length!==1}),(w,n)=>{const v=l("v-select"),t=l("v-list-item"),f=l("v-icon"),c=l("v-list-item-title"),A=l("v-list-group"),G=l("v-list");return r(),S(G,{dense:""},{default:e(()=>[o(t,null,{default:e(()=>[u.value?(r(),S(v,{key:0,modelValue:y.value,"onUpdate:modelValue":[n[0]||(n[0]=s=>y.value=s),a],class:"mt-3 mb-3",transition:"fab-transition",items:m.value,"item-title":"role_name","item-value":"role_id",density:"compact",variant:"outlined",label:"Switch Account","append-inner-icon":"mdi-account-outline"},null,8,["modelValue","items"])):U("",!0)]),_:1}),m.value.length>0?(r(!0),I(V,{key:0},B(k.value,(s,ee)=>(r(),I(V,null,[s.children?(r(),S(A,{key:0},{activator:e(({props:x})=>[o(t,T({color:"primary"},x),{prepend:e(()=>[o(f,{class:"myIcon"},{default:e(()=>[d(i(s.icong),1)]),_:2},1024)]),default:e(()=>[o(c,{color:"primary"},{default:e(()=>[d(i(s.module),1)]),_:2},1024)]),_:2},1040)]),default:e(()=>[(r(!0),I(V,null,B(s.children,(x,$)=>(r(),S(t,{key:$,to:{name:x.name},link:"","active-class":"active-link"},{prepend:e(()=>[o(f,{class:"myIcon"},{default:e(()=>[d(i(x.icong),1)]),_:2},1024)]),default:e(()=>[o(c,null,{default:e(()=>[d(i(x.module),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:2},1024)):(r(),S(t,{key:1,to:{name:s.name},link:"","active-class":"active-link"},{prepend:e(()=>[o(f,{class:"myIcon"},{default:e(()=>[d(i(s.icong),1)]),_:2},1024)]),default:e(()=>[o(c,null,{default:e(()=>[d(i(s.module),1)]),_:2},1024)]),_:2},1032,["to"]))],64))),256)):U("",!0)]),_:1})}}},ne=z(Y,[["__scopeId","data-v-9b58e7fa"]]),K={class:"text-right pa-4"},Q={class:"text-dark"},W=C("br",null,null,-1),X={class:"small mr-4 text-disabled"},Z={class:"text-disabled"},ae={__name:"topBarUserProfile",setup(M){const g=O(),h=j();N();const _=R(!1),p=R(!1),b=D(),y=P(()=>{var u;return(u=g.user.user_roles.find(a=>b.currentUserRole===a.role_id))==null?void 0:u.role_name}),m=async()=>{_.value=!0;try{await h.log_me_out(),window.location.href="/",_.value=!1}catch(u){alert(u)}finally{_.value=!1}};return(u,a)=>{const k=l("v-btn"),w=l("v-spacer"),n=l("v-card"),v=l("v-dialog");return r(),I("div",K,[o(k,{onClick:a[0]||(a[0]=t=>p.value=!0),color:"primary",class:"text-none","prepend-icon":"mdi-account"},{default:e(()=>[C("span",Q,[C("b",null,i(L(g).user.first_name)+" "+i(L(g).user.last_name),1)]),d(" | Logout ")]),_:1}),W,C("span",X,[d("Logged in as : "),C("b",Z,i(y.value),1)]),o(v,{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=t=>p.value=t),width:"auto"},{default:e(()=>[o(n,{"min-width":"300","prepend-icon":"mdi-account",text:"Are you sure you want to leave?",title:"Logout"},{actions:e(()=>[o(w),o(k,{class:"text-none",variant:"tonal",color:"primary",text:"Cancel",onClick:a[1]||(a[1]=t=>p.value=!1)}),o(k,{class:"text-none",color:"primary","min-width":"150px",variant:"flat",text:"Yes",loading:_.value,onClick:m},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"])])}}};export{ne as B,ae as _};
