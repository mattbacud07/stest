import{s as Z,ao as ee,c as W,r as o,x as Q,e as r,o as n,n as f,h as t,w as l,k as e,F as Y,y as K,t as m,j as y,f as N,m as i,H as j,b as ue,A as H,B as de,d as ce,ap as _e,v as te,an as le,E as me,i as pe,I as ve,aa as X,a9 as fe,a2 as ye}from"./index-C8ph-EQq.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";const be=e("h5",{class:"p-3",style:{"font-weight":"700",color:"#191970"}},"EQUIPMENT & PERIPHERALS",-1),he={class:"table-responsive"},Se={class:"table table-sm table-bordered"},xe=e("thead",{style:{background:"#afafaf2e"}},[e("tr",null,[e("th",{scope:"col"},"Item Code"),e("th",{scope:"col"},"Item Description"),e("th",{scope:"col"},"Serial Number"),e("th",{scope:"col"},"Remarks")])],-1),ke={key:0},De={style:{"min-width":"250px"}},we={key:1},qe={colspan:"5",class:"text-center p-3",style:{opacity:".3"}},Ve=e("br",null,null,-1),Re={class:"p-3 mt-2",style:{"font-weight":"500",color:"#191970"}},Ie={style:{"font-size":".8em","font-weight":"400",color:"#777"}},$e={key:0},Ne={class:"table-responsive"},Ee={class:"table table-sm table-bordered table-responsive"},Te=e("thead",{style:{background:"#afafaf2e"}},[e("tr",null,[e("th",{scope:"col"},"Item Code"),e("th",{scope:"col"},"Item Description"),e("th",{scope:"col"},"Serial Number"),e("th",{scope:"col"},"Remarks")])],-1),Ue={key:0},Ae={style:{"min-width":"250px"}},Pe={key:1},Be={key:1},Ce={colspan:"5",class:"text-center p-3",style:{opacity:".3"}},ze=e("br",null,null,-1),ut={__name:"RequestedEquipments",props:{service_id:{type:Number},status:{type:Number},editSerial:{type:Boolean}},emits:["set-serial","get-serials","get-serial-numbers","get-equipments-data"],setup(U){const{width:A}=Z(),R=ee(),I=de,x=W(),g=o([]),b=o([]),E=o(null),P=o([c=>!!c||"Required field"]);o("");const $=U,h=()=>{},k=async()=>{const c=await ue.get(I+"api/get-equipments",{params:{service_id:$.service_id},headers:{Authorization:`Bearer ${x.tokenData}`}});if(c.data&&c.data.equipments){const D=c.data.equipments;g.value=D.filter(v=>v.category==="Equipment"),b.value=D.filter(v=>v.category==="Peripheral"),R.emit("get-serials",g.value)}else alert("Something went wrong")},B=()=>{H(()=>b.value.map(c=>({id:c.equipment_id,serial:c.peripheralSerial})),c=>{R.emit("set-serial",c)})};return Q(()=>{k()}),(c,D)=>{const v=r("v-icon"),d=r("v-col"),w=r("v-row"),O=r("v-card"),S=r("v-text-field"),M=r("v-form");return n(),f(Y,null,[t(O,{class:"mt-3 p-3",elevation:"0"},{default:l(()=>[t(w,null,{default:l(()=>[be,t(d,{cols:"12"},{default:l(()=>[e("div",he,[e("table",Se,[xe,g.value.length>0?(n(),f("tbody",ke,[(n(!0),f(Y,null,K(g.value,(_,C)=>(n(),f("tr",{key:C},[e("td",null,m(_.item_code),1),e("td",De,m(_.description),1),e("td",null,m(_.serial_number),1),e("td",null,m(_.remarks),1)]))),128))])):(n(),f("tbody",we,[e("tr",null,[e("td",qe,[t(v,{class:"mb-3",style:{"font-size":"50px"}},{default:l(()=>[y("mdi-file-document-alert-outline")]),_:1}),Ve,y(" No records found ")])])]))])])]),_:1})]),_:1})]),_:1}),b.value.length>0?(n(),N(O,{key:0,class:"mt-3 p-3 rounded-0",elevation:"0",style:{"border-top":"1px dashed #191970"}},{default:l(()=>[t(w,null,{default:l(()=>[e("h5",Re,[y("ADDITIONAL PERIPHERALS "),e("span",Ie,[e("i",null,[i(A)<615?(n(),f("br",$e)):j("",!0),y(" (Serial number to be filled by the IT Department)")])])]),t(d,{cols:"12"},{default:l(()=>[e("div",Ne,[e("table",Ee,[Te,b.value.length>0?(n(),f("tbody",Ue,[(n(!0),f(Y,null,K(b.value,(_,C)=>(n(),f("tr",{key:C},[e("td",null,m(_.item_code),1),e("td",Ae,m(_.description),1),e("td",null,[i(x).user.approval_level===1&&U.editSerial===!0?(n(),N(M,{key:0,ref_for:!0,ref_key:"form",ref:E,onPrevent:h},{default:l(()=>[t(S,{clearable:"",density:"compact",variant:"plain",rules:P.value,placeholder:"Serial number ....","w-100":"",modelValue:_.peripheralSerial,"onUpdate:modelValue":p=>_.peripheralSerial=p,onInput:B},null,8,["rules","modelValue","onUpdate:modelValue"])]),_:2},1536)):(n(),f("span",Pe,m(_.serial_number),1))]),e("td",null,m(_.remarks),1)]))),128))])):(n(),f("tbody",Be,[e("tr",null,[e("td",Ce,[t(v,{class:"mb-3",style:{"font-size":"50px"}},{default:l(()=>[y("mdi-file-document-alert-outline")]),_:1}),ze,y(" No records found ")])])]))])])]),_:1})]),_:1})]),_:1})):j("",!0)],64)}}},Oe={class:"bg-grey-lighten-5 rounded p-4 border-dashed border-sm"},Fe=e("h5",{style:{"font-weight":"500",color:"#191970"}},[e("span",null,"Service Department - Internal Servicing")],-1),Le=e("h5",{class:"mt-3",style:{"font-weight":"500",color:"#191970"}},"Internal Servicing",-1),je=e("span",{class:"text-dark mr-2"},"Status:",-1),Me={class:"d-flex align-items-center"},Ye=e("span",{class:"text-grey"},"Delegated to:",-1),He={class:"ml-2 text-dark"},We=e("label",{class:"text-grey"},"Delegation Date",-1),Qe={class:"mt-2"},Ge=e("label",{class:"text-grey"},"Date Started",-1),Je={class:"mt-2"},Ke=e("label",{class:"text-grey"},"Date Accomplished",-1),Xe={class:"mt-2"},Ze=e("label",{class:"text-grey"},"Packed & Endorsed to Warehouse",-1),et={class:"mt-2"},tt=e("label",{class:"text-grey"},"Endorsement Date",-1),lt={class:"mt-2"},at=e("label",{class:"text-grey"},"Confirmed by Warehouse",-1),st={class:"mt-2"},ot={__name:"InternalRequest",props:{service_id:{type:Number},getSelectedRequest:{type:Number},other:{type:String},internalStatus:{type:Number,default:0},internalDelegatedTo:{type:String,default:""},internalID:{type:Number,default:null},internalServicing:{type:Object,default:null}},setup(U){const A=ce.useToast(),R=o(!1),I=o(null),x=o(""),g=o([]),b=o(!1),E=o(!1),P=o(!1),$=o(!1),h=o(""),k=o(!1),B=_e("disableButton",null),c=W();c.getUserData;const D=te(),v=U,{internalServicing:d}=le(v),w=s=>s!==null?ye(s).format("MM/DD/YYYY hh:mm a"):"--";H(I,(s,a)=>{$.value=s==="12",$.value||(h.value="")});const O=o([s=>!!s||"Select an option from the list"]),S=o([s=>!!s||"Required field"]),M=o([s=>!!s||"Required field",s=>s.key!==void 0?!0:"Select an option from the list",s=>s.value!==void 0?!0:"Select an option from the list"]),_=async()=>{E.value=!0;const{valid:s}=await b.value.validate();if(!s){E.value=!1;return}try{const a=await D.post("internal-process",{received_by:c.user.id,service_id:v.service_id,type_of_activity:I.value,other:h.value,delegated_to:x.value.value});a.data&&a.data.success?(A.success("Successfully delegated"),typeof B=="function"&&B(),setTimeout(()=>{window.location.reload()},1e3)):a.data&&a.data.exist_service_id&&A.warning("Request currently delegated")}catch(a){alert(a)}finally{E.value=!1,R.value=!1}},C=async()=>{try{const s=await D.get("get-engineers-data");if(s.data&&s.data.engineers){const a=s.data.engineers.map(u=>({key:u.users.first_name+" "+u.users.last_name,value:u.user_id}));g.value=a}}catch(s){alert(s)}},p=()=>{v.getSelectedRequest===0?k.value=!1:(k.value=!0,I.value=String(v.getSelectedRequest),h.value=String(v.other))};return Q(()=>{C(),p()}),(s,a)=>{var G,J;const u=r("v-col"),z=r("v-row"),F=r("v-icon"),T=r("v-btn"),q=r("v-divider"),L=r("v-radio"),ae=r("v-radio-group"),se=r("v-text-field"),oe=r("v-combobox"),ne=r("v-form"),re=r("v-card"),ie=r("v-dialog");return n(),f("div",Oe,[t(z,null,{default:l(()=>[t(u,{cols:"12"},{default:l(()=>[Fe]),_:1})]),_:1}),i(d)&&!((J=(G=i(d))==null?void 0:G.get_user)!=null&&J.id)?(n(),N(u,{key:0,cols:"12"},{default:l(()=>[t(ie,{modelValue:R.value,"onUpdate:modelValue":a[4]||(a[4]=V=>R.value=V),"max-width":"500",persistent:""},{activator:l(({props:V})=>[t(T,me({type:"button",variant:"tonal"},V,{color:"primary",class:"text-none btnSubmit mt-3"}),{default:l(()=>[t(F,{class:"mr-2"},{default:l(()=>[y("mdi-transfer-right")]),_:1}),y(" Start")]),_:2},1040)]),default:l(()=>[t(re,null,{default:l(()=>[t(ne,{onSubmit:pe(_,["prevent"]),ref_key:"form",ref:b},{default:l(()=>[t(u,{cols:"12"},{default:l(()=>[Le,t(q),t(ae,{modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=V=>I.value=V),rules:O.value,readonly:k.value},{default:l(()=>[t(L,{color:"primary",label:"For Corrective",value:"7"}),t(L,{color:"primary",label:"For Refurbishment",value:"8"}),t(L,{color:"primary",label:"For Quality Control",value:"9"}),t(L,{color:"primary",label:"Training Purposes",value:"10"}),t(L,{color:"primary",label:"For Disposal",value:"11"}),t(L,{color:"primary",label:"Other",value:"12"})]),_:1},8,["modelValue","rules","readonly"]),$.value?(n(),N(se,{key:0,rules:S.value,modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=V=>h.value=V),readonly:k.value,density:"compact",variant:"outlined",label:"Other Request"},null,8,["rules","modelValue","readonly"])):j("",!0),t(oe,{color:"primary",class:"mt-5",modelValue:x.value,"onUpdate:modelValue":a[2]||(a[2]=V=>x.value=V),rules:M.value,clearable:"",label:"Delegate to",placeholder:"Delegate to",density:"compact",items:g.value,variant:"outlined",itemValue:"value",itemTitle:"key"},null,8,["modelValue","rules","items"])]),_:1}),t(q,{class:"mb-5"}),t(z,{justify:"end",class:"mb-3"},{default:l(()=>[t(T,{elevation:"2",onClick:a[3]||(a[3]=V=>R.value=!1),"background-color":"red",size:"small",class:"text-none mr-2"},{default:l(()=>[t(F,null,{default:l(()=>[y("mdi-close")]),_:1}),y(" Cancel")]),_:1}),t(T,{type:"submit",size:"small",loading:E.value,disabled:P.value,color:"#191970",class:"text-none bg-primary mr-5"},{default:l(()=>[t(F,{class:"mr-2"},{default:l(()=>[y("mdi-check")]),_:1}),y(" Delegate")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]),_:1})):j("",!0),i(d)&&i(d).status?(n(),N(z,{key:1},{default:l(()=>[t(u,{cols:"12",xl:"8",md:"8",sm:"8"},{default:l(()=>[e("p",null,[je,e("span",{style:ve({color:X(i(d).status).color})},m(i(d).status===fe.Delegated?"Waiting for Acceptance":X(i(d).status).text),5)])]),_:1}),t(u,{cols:"12",xl:"4",md:"4",sm:"4"},{default:l(()=>[e("p",Me,[Ye,y(),e("span",He,m(i(d).get_user.first_name)+" "+m(i(d).get_user.last_name),1)])]),_:1}),t(u,{cols:"12",xl:"4",md:"4",sm:"4"},{default:l(()=>[We,e("p",Qe,m(w(i(d).delegation_date)),1)]),_:1}),t(u,{cols:"12",xl:"4",md:"4",sm:"4"},{default:l(()=>[Ge,e("p",Je,m(w(i(d).date_started)),1)]),_:1}),t(u,{cols:"12",xl:"4",md:"4",sm:"4"},{default:l(()=>[Ke,e("p",Xe,m(w(i(d).accomplished_date)),1)]),_:1}),t(u,{cols:"12",xl:"4",md:"4",sm:"8"},{default:l(()=>[Ze,e("p",et,m(i(d).packed_endorse_to_warehouse?"Yes":"--"),1)]),_:1}),t(u,{cols:"12",xl:"4",md:"4",sm:"4"},{default:l(()=>[tt,e("p",lt,m(w(i(d).endorsement_date)),1)]),_:1}),t(u,{cols:"12",xl:"4",md:"4",sm:"4"},{default:l(()=>[at,e("p",st,m(w(i(d).accepted_by_warehouse)),1)]),_:1})]),_:1})):j("",!0)])}}},nt={__name:"RequestDetails",props:{service_id:{type:Number},showInternalRequest:{type:Boolean,default:()=>!1},internalStatus:{type:Number,default:0},internalDelegatedTo:{type:String,default:""},internalID:{type:Number,default:null},internalServicing:{type:Object,default:null}},emits:["set-status","set-updated-ssu","get-installation-engineer"],setup(U){const{width:A}=Z(),R=W(),I=te();o([]);const x=ee(),g=o(!1),b=o(""),E=o(""),P=o(""),$=o(""),h=o(""),k=o(""),B=o(""),c=o(!1),D=U,{internalStatus:v,internalDelegatedTo:d,internalID:w,internalServicing:O}=le(D),S=o(6);H(A,p=>{p<550?S.value=12:S.value=6});const M=async()=>{try{g.value=!0;const p=await I.get("get-specific-equipment-handling",{params:{service_id:D.service_id}});if(p.data&&p.data.equipment_handling){const a=p.data.equipment_handling[0];$.value=a.name??0,h.value=a.address,P.value=a.first_name+" "+a.last_name,k.value=a.proposed_delivery_date,B.value=a.request_type.toString(),c.value=a.bypass===1,b.value=a.status,E.value=a.main_status,x.emit("set-status",a.status),x.emit("set-updated-ssu",a.ssu),x.emit("get-installation-engineer",a.installer)}else alert("Something went wrong")}catch(p){console.log(p)}finally{g.value=!1}},_=o(null);H(B,p=>{_.value=parseInt(p)});const C=()=>{S.value=A.value<550?12:6};return Q(()=>{M(),C()}),(p,s)=>{const a=r("v-skeleton-loader"),u=r("v-col"),z=r("v-row"),F=r("v-card"),T=r("v-text-field");return n(),f(Y,null,[t(F,{flat:"",class:"mb-5 mt-7"},{default:l(()=>[t(z,null,{default:l(()=>[g.value?(n(),N(a,{key:0,type:"list-item",class:"mb-2"})):(n(),f(Y,{key:1},[U.showInternalRequest&&!c.value&&b.value===i(R).user.approval_level?(n(),N(u,{key:0,cols:"12"},{default:l(()=>[t(ot,{service_id:D.service_id,getSelectedRequest:_.value>=7?_.value:0,other:p.other??"",internalStatus:i(v),internalDelegatedTo:i(d),internalID:i(w),internalServicing:i(O)},null,8,["service_id","getSelectedRequest","other","internalStatus","internalDelegatedTo","internalID","internalServicing"])]),_:1})):j("",!0)],64))]),_:1})]),_:1}),g.value?(n(),N(a,{key:0,type:"list-item, list-item, button, table-row, table-tbody",class:"mb-2"})):(n(),N(F,{key:1,flat:"",style:{"padding-top":"1em"}},{default:l(()=>[t(z,null,{default:l(()=>[t(u,{cols:S.value},{default:l(()=>[t(T,{color:"primary",density:"compact",label:"Institution",placeholder:"Institution",variant:"outlined",readonly:"",modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=q=>$.value=q)},null,8,["modelValue"])]),_:1},8,["cols"]),t(u,{cols:S.value},{default:l(()=>[t(T,{color:"primary",density:"compact",label:"Requested by",placeholder:"Requested by",variant:"outlined",readonly:"",modelValue:P.value,"onUpdate:modelValue":s[1]||(s[1]=q=>P.value=q)},null,8,["modelValue"])]),_:1},8,["cols"])]),_:1}),t(z,null,{default:l(()=>[t(u,{cols:S.value},{default:l(()=>[t(T,{color:"primary",modelValue:h.value,"onUpdate:modelValue":s[2]||(s[2]=q=>h.value=q),label:"Address",density:"compact",variant:"outlined",readonly:""},null,8,["modelValue"])]),_:1},8,["cols"]),t(u,{cols:S.value},{default:l(()=>[t(T,{color:"primary",modelValue:k.value,"onUpdate:modelValue":s[3]||(s[3]=q=>k.value=q),label:"Propose Delivery Date",density:"compact",variant:"outlined",readonly:""},null,8,["modelValue"])]),_:1},8,["cols"])]),_:1})]),_:1}))],64)}}},dt=ge(nt,[["__scopeId","data-v-4b82f6b6"]]);export{dt as R,ut as _};
