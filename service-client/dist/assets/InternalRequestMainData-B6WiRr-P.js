import{s as de,u as ce,c as me,v as pe,g as _e,r as n,ak as fe,P as R,A as ve,D as he,x as ge,f as g,w as e,U as we,al as ye,am as be,o as m,h as o,E as J,H as f,m as w,j as y,n as b,y as Ie,F as Se,k as u,t as c,V as ke,N as p,aa as q,I as xe,a9 as N,e as d,L as De,M as Ce}from"./index-C8ph-EQq.js";import{L as Ve}from"./LayoutWithActions-lJJIN9jM.js";import{g as Re}from"./vue3-datatable-BuM4cnvr.js";/* empty css              */import{O as qe}from"./main-Z0aCj2Rp.js";import{_ as Ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./topBarUserProfile-ExGO6QtX.js";import"./logout-D7B5usQQ.js";import"./permitted-BzPEUTiR.js";const Pe=v=>(De("data-v-f5cbea2c"),v=v(),Ce(),v),Ue={style:{position:"absolute",bottom:"0!important",left:"0",width:"100%"},class:"d-flex justify-content-center"},Be={key:0},Ae=Pe(()=>u("br",null,null,-1)),Fe={key:0,class:"small"},Me={key:1,class:"small"},We={__name:"InternalRequestMainData",setup(v){const{width:$}=de(),H=ce(),Y=me(),P=pe(),U=_e().currentUserRole,B=n(null),G=n(N),i=n({filterStatus:[],filterInstitution:[],delegation_date:""}),K=()=>{i.value={filterStatus:[],filterInstitution:[],delegation_date:""},localStorage.removeItem("ISFilter")},A=fe(()=>Object.values(i.value).filter(t=>Array.isArray(t)&&t.length>0||typeof t=="string"&&t.trim()!=="").length),I=n(!1),S=n(!0),F=n(null),k=n(!1),M=n(null),W=n(null),Q=n(null),X=n("InternalServicingProcess");R("data",{selectedId:M,service_id:W,status:Q,btnDisable:S,routeView:X});const O=n([]),Z=t=>{O.value=F.value.getSelectedRows(),t&&t.length===1?S.value=!1:S.value=!0,M.value=t.map(l=>l.equipment_handling.id)[0],W.value=t.map(l=>l.id)[0]},ee=t=>O.value.map(r=>r.id).includes(t.id)?"highlightRow":"",te=t=>{H.push({name:"InternalServicingProcess",params:{id:t.service_id,service_id:t.id}})};ve(i,t=>{localStorage.setItem("ISFilter",JSON.stringify(t)),C()},{deep:!0}),n(!1);const x=n(!0),ae=n(0),E=he({current_page:1,pagesize:10,sort_column:"id",sort_direction:"asc"}),L=n(null),T=n([{field:"id",title:"ID",isUnique:!0,type:"number",hide:!0,width:"auto"},{field:"equipment_handling.id",title:"Report Number",filter:!0,width:"auto",hide:!1},{field:"equipment_handling.institution_name",title:"Institution",filter:!0,width:"auto",hide:!1},{field:"equipment_handling.ssu",title:"SSU",filter:!0,width:"auto",hide:!1},{field:"equipment_handling.proposed_delivery_date",title:"Proposed Delivery Date",filter:!0,width:"auto",hide:!1},{field:"equipment_handling.created_at",title:"Date Requested",filter:!0,width:"auto",hide:!0},{field:"internal_external_name.name",title:"Type of Activity",filter:!0,width:"auto",hide:!1},{field:"delegation_date",title:"Delegation Date",width:"auto",hide:!1},{field:"date_started",title:"Date Started",width:"auto",hide:!1},{field:"accomplished_date",title:"Date Accomplished",width:"auto",hide:!1},{field:"packed_endorse_to_warehouse",title:"Packed & Endorsed to Warehouse",minWidth:"200px",hide:!0},{field:"endorsement_date",title:"Endorsement Date",width:"auto",hide:!1},{field:"accepted_by_warehouse",title:"Confirmed by Warehouse",minWidth:"200px",hide:!1},{field:"status",title:"Status",width:"auto",hide:!1}])||[];R("column",T);const D=n(""),C=async()=>{var t;U===we&&(D.value="delegated_to"),U===ye&&(D.value=be);try{x.value=!0;const r=(await P.get("getInternalRequest",{params:{user_id:Y.user.id,...i.value,category:D.value}})).data.request;L.value=r,ae.value=(t=r==null?void 0:r.meta)==null?void 0:t.total}catch(l){alert(l)}x.value=!1};R("refresh",C);const j=n([]),le=async()=>{try{k.value=!0;const t=await P.get("get_institution");if(t.data&&t.data.institutions){const l=t.data.institutions;j.value=l.map(r=>({iName:r.name,iId:r.id}))}}catch(t){console.log(t)}finally{k.value=!1}};return ge(()=>{const t=localStorage.getItem("ISFilter");t&&(i.value=JSON.parse(t)),C(),le()}),(t,l)=>{const r=d("v-badge"),h=d("v-btn"),oe=d("v-icon"),ne=d("v-checkbox"),V=d("v-card"),z=d("v-menu"),_=d("v-col"),se=d("v-combobox"),ie=d("v-spacer"),re=d("v-row");return m(),g(Ve,null,{filter:e(()=>[o(z,{modelValue:I.value,"onUpdate:modelValue":l[5]||(l[5]=s=>I.value=s),"close-on-content-click":!1,location:"bottom",transition:"slide-x-reverse-transition"},{activator:e(({props:s})=>[o(h,J({color:"primary","prepend-icon":"mdi-filter-outline",variant:"tonal",text:"Advanced filtering",class:"text-none"},s),{append:e(()=>[A.value>0?(m(),g(r,{key:0,color:"warning",content:A.value,class:"ml-2 mr-2"},null,8,["content"])):f("",!0)]),_:2},1040)]),default:e(()=>[o(V,{"min-width":"350",width:w($)<500?"350":"500","max-width":"500","min-height":"500",style:{"overflow-x":"hidden!important"}},{default:e(()=>[o(re,null,{default:e(()=>[o(_,{cols:"12"},{default:e(()=>[o(_,{cols:"12"},{default:e(()=>[o(z,{modelValue:B.value,"onUpdate:modelValue":l[1]||(l[1]=s=>B.value=s),"close-on-content-click":!1,"min-width":"400",width:"400",height:"auto",location:"bottom"},{activator:e(({props:s})=>[o(h,J({color:"primary",variant:"tonal"},s,{class:"text-none"}),{default:e(()=>[i.value.filterStatus.length>0?(m(),g(r,{key:0,color:"primary",content:i.value.filterStatus.length,class:"mr-3 ml-2"},null,8,["content"])):f("",!0),y(" Status "),o(oe,null,{default:e(()=>[y("mdi-chevron-down")]),_:1})]),_:2},1040)]),default:e(()=>[o(V,{width:"auto",class:"pr-3"},{default:e(()=>[(m(!0),b(Se,null,Ie(G.value,(s,a)=>(m(),g(ne,{modelValue:i.value.filterStatus,"onUpdate:modelValue":l[0]||(l[0]=ue=>i.value.filterStatus=ue),class:"columnChooserCheckBox",label:q(s).text,value:s,key:s},null,8,["modelValue","label","value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(_,{cols:"12"},{default:e(()=>[o(se,{loading:k.value,color:"primary",modelValue:i.value.filterInstitution,"onUpdate:modelValue":l[2]||(l[2]=s=>i.value.filterInstitution=s),label:"Institution",density:"compact",items:j.value,chips:"","closable-chips":"","single-line":"",itemValue:"iId",variant:"outlined",itemTitle:"iName",multiple:""},null,8,["loading","modelValue","items"])]),_:1}),o(_,{cols:"12"},{default:e(()=>[o(w(qe),{modelValue:i.value.delegation_date,"onUpdate:modelValue":l[3]||(l[3]=s=>i.value.delegation_date=s),"auto-apply":"",range:"","model-type":"yyyy-MM-dd","enable-time-picker":!1,placeholder:"Delegation Date"},null,8,["modelValue"])]),_:1}),o(_,{cols:"12"},{default:e(()=>[u("div",Ue,[o(ie),o(h,{variant:"tonal",onClick:l[4]||(l[4]=s=>I.value=!1),class:"text-none rounded-0",style:{width:"50%"}},{default:e(()=>[y(" Close ")]),_:1}),o(h,{color:"primary",variant:"flat","prepend-icon":"mdi-close",onClick:K,class:"text-none rounded-0",style:{width:"50%"}},{default:e(()=>[y(" Clear ")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["width"])]),_:1},8,["modelValue"])]),default:e(({searchText:s})=>[o(V,{class:"mx-auto mt-10"},{default:e(()=>[o(w(Re),{ref_key:"datatable",ref:F,rows:L.value,sort:!0,columns:w(T),loading:x.value,search:s,sortable:!0,sortColumn:E.sort_column,sortDirection:E.sort_direction,skin:"bh-table-hover bh-table-compact bh-table-bordered",hasCheckbox:!0,selectRowOnClick:!0,onRowSelect:Z,onRowDBClick:te,rowClass:ee,cellClass:"internalCell",class:"tableLimitText"},{"equipment_handling.id":e(a=>[u("span",null,c(ke(a.value.equipment_handling.id,a.value.created_at)),1)]),"equipment_handling.created_at":e(a=>[u("span",null,c(p(a.value.created_at)),1)]),"equipment_handling.proposed_delivery_date":e(a=>[u("span",null,c(p(a.value.equipment_handling.proposed_delivery_date)),1)]),delegation_date:e(a=>[u("span",null,c(p(a.value.delegation_date)),1)]),date_started:e(a=>[u("span",null,c(p(a.value.date_started)),1)]),accomplished_date:e(a=>[u("span",null,c(p(a.value.accomplished_date)),1)]),packed_endorse_to_warehouse:e(a=>[a.value.packed_endorse_to_warehouse?(m(),b("span",Be,"Yes")):f("",!0)]),endorsement_date:e(a=>[u("span",null,c(p(a.value.endorsement_date)),1)]),accepted_by_warehouse:e(a=>[u("span",null,c(p(a.value.accepted_by_warehouse)),1)]),status:e(a=>[u("span",{class:"text-dark",style:xe({fontWeight:"700",color:q(a.value.status).color})},c(q(a.value.status).text),5),Ae,a.value.status===N.ConfirmedByWIM?(m(),b("span",Fe,"Internal Process Completed")):f("",!0),a.value.status===N.Packed?(m(),b("span",Me,"Warehouse Confirmation Pending")):f("",!0)]),_:2},1032,["rows","columns","loading","search","sortColumn","sortDirection"])]),_:2},1024)]),_:1})}}},Ke=Ne(We,[["__scopeId","data-v-f5cbea2c"]]);export{Ke as default};
